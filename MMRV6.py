##TECHNOLOGY_BY_LTKYAW

import base64
exec(base64.b64decode('IyEvdXNyL2Jpbi9weXRob24KIyAtKi0gY29kaW5nOiB1dGYtOCAtKi0KIyAtLS0tLS0gWyBHYXVzYWggRGlvcHJlayBOdGFyIEVycm9yIF0gLS0tLS0tICMKQXV0aG9yICAgID0gJ01oZCBTeWFmaWknCkZhY2Vib29rICA9ICdGYWNlYm9vay5jb20vZmlrcml0YW1wYW4zMDUnCkluc3RhZ3JhbSA9ICdJbnN0YWdyYW0uY29tL2ZpX3NpbmFnYScKV2hhdHNhcHAgID0gJzA4MTI2OTQ5NjIzMScKWW91VHViZSAgID0gJ1lvdXR1YmUuY29tL2NoYW5uZWwvVUNacW5abEowamZvV1NuWHJORWo1SkhBJwpTeWFmaWkgID0gMTAwMDgwNzE2NzE4MDM1ClBvc3RpbmdhbiA9IDExNTc1MzA1NDQ1ODU4NQprb21lbnRhciAgID0gJ1xuXG5odHRwczovL3d3dy5mYWNlYm9vay5jb20vJyArIHN0cihQb3N0aW5nYW4pCiMjIyMjIC0+IElNUE9SVCBNT0RVTEUKaW1wb3J0IHJlcXVlc3RzLGJzNCxzeXMsb3MscmFuZG9tLHRpbWUscmUsanNvbix1dWlkLHN1YnByb2Nlc3MKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKZnJvbSBjb25jdXJyZW50LmZ1dHVyZXMgaW1wb3J0IFRocmVhZFBvb2xFeGVjdXRvciBhcyBUaHJlYWRQb29sCmZyb20gcmVxdWVzdHMuZXhjZXB0aW9ucyBpbXBvcnQgQ29ubmVjdGlvbkVycm9yCmZyb20gY29uY3VycmVudC5mdXR1cmVzIGltcG9ydCBUaHJlYWRQb29sRXhlY3V0b3IKZnJvbSBiczQgaW1wb3J0IEJlYXV0aWZ1bFNvdXAgYXMgcGFyCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwIGFzIHBhcnNlcgpmcm9tIGJzNCBpbXBvcnQgQmVhdXRpZnVsU291cApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQojIyMjIyBCVUFUIFdBUk5BIC0+IFgKWiA9ICJceDFiWzA7OTBtIiAgICAgIyBIaXRhbQpNID0gIlx4MWJbMzg7NTsxOTZtIiAjIE1lcmFoCkggPSAiXHgxYlszODs1OzQ2bSIgICMgSGlqYXUKSyA9ICJceDFiWzM4OzU7MjI2bSIgIyBLdW5pbmcKQiA9ICJceDFiWzM4OzU7NDRtIiAgIyBCaXJ1ClUgPSAiXHgxYlsxOzk1bSIgICAgICMgVW5ndQpJID0gIlx4MWJbMTs5Nm0iICAgICAjIEJpcnUgTXVkYQpQID0gIlx4MWJbMzg7NTsyMzFtIiAjIFB1dGloCkogPSAiXHgxYlszODs1OzIwOG0iICMgSmluZ2dhCkEgPSAiXHgxYlszODs1OzI0OG0iICMgQWJ1LUFidQojIyMjIyBCVUFUIElNUE9SVCBZRyBCRUxVTSBJTlNUQUxMIEFIQUhIQUEKdHJ5OgoJaW1wb3J0IHJlcXVlc3RzCmV4Y2VwdCBJbXBvcnRFcnJvcjoKCXByaW50KGYie0J9IHwgIikKCXByaW50KGYie1B9Wypde019IE1vZHVsZSByZXF1ZXN0cyBiZWx1bSB0ZXJpbnN0YWxsIikKCW9zLnN5c3RlbSgicGlwIGluc3RhbGwgcmVxdWVzdHMiKQp0cnk6CglpbXBvcnQgYnM0CmV4Y2VwdCBJbXBvcnRFcnJvcjoKCXByaW50KGYie0J9IHwgIikKCXByaW50KGYie1B9Wypde019IE1vZHVsZSBiczQgYmVsdW0gdGVyaW5zdGFsbCIpCglvcy5zeXN0ZW0oInBpcCBpbnN0YWxsIGJzNCIpCnRyeToKCWltcG9ydCBjb25jdXJyZW50LmZ1dHVyZXMKZXhjZXB0IEltcG9ydEVycm9yOgoJcHJpbnQoZiJ7Qn0gfCAiKQoJcHJpbnQoZiJ7UH1bKl17TX0gTW9kdWxlIGZ1dHVyZXMgYmVsdW0gdGVyaW5zdGFsbCIpCglvcy5zeXN0ZW0oInBpcCBpbnN0YWxsIGZ1dHVyZXMiKQpob3N0ID0gKCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iKQpCID0gcmFuZG9tLmNob2ljZShbSCxVLEosS10pCiMjIyMgQlVBVCBCQU5ORVIKZGVmIGJhbm5lcigpOgogICAgd2FyX2RvbSA9IHJhbmRvbS5jaG9pY2UoW1AsSyxCLEosVSxIXSkKICAgIHByaW50KCIiIgoqX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyoKCiAg4paI4paI4paIICAgIOKWiOKWiOKWiCDilojilojiloggICAg4paI4paI4paIIOKWiOKWiOKWiOKWiOKWiOKWiCAg4paI4paIICAgIOKWiOKWiCAg4paI4paI4paI4paI4paI4paIICAKICDilojilojilojiloggIOKWiOKWiOKWiOKWiCDilojilojilojiloggIOKWiOKWiOKWiOKWiCDilojiloggICDilojilogg4paI4paIICAgIOKWiOKWiCDilojiloggICAgICAgCiAg4paI4paIIOKWiOKWiOKWiOKWiCDilojilogg4paI4paIIOKWiOKWiOKWiOKWiCDilojilogg4paI4paI4paI4paI4paI4paIICDilojiloggICAg4paI4paIIOKWiOKWiOKWiOKWiOKWiOKWiOKWiCAgCiAg4paI4paIICDilojiloggIOKWiOKWiCDilojiloggIOKWiOKWiCAg4paI4paIIOKWiOKWiCAgIOKWiOKWiCAg4paI4paIICDilojiloggIOKWiOKWiCAgICDilojiloggCiAg4paI4paIICAgICAg4paI4paIIOKWiOKWiCAgICAgIOKWiOKWiCDilojiloggICDilojiloggICDilojilojilojiloggICAg4paI4paI4paI4paI4paI4paIICAKCiAgIHsgQVVUSE9SIC0+IExUS1lBVyB9ICsgeyBGQiBDUkFDSyBUT09MIDIwMjIgfQoqX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXyoKIHwiIiIpCgoKIyMjLS0tLS0tLS0tLVsgVElNRSBdLS0tLS0tLS0tLSAjIyMKc2tybmcgPSBkYXRldGltZS5ub3coKQp0YWh1biA9IHNrcm5nLnllYXIKYnVsYW4gPSBza3JuZy5tb250aApoYXJpICA9IHNrcm5nLmRheQpidWxhbl90dGwgPSB7IjAxIjogIkphbnVhcnkiLCAiMDIiOiAiRmVicnVhcnkiLCAiMDMiOiAiTWFyY2giLCAiMDQiOiAiQXByaWwiLCAiMDUiOiAiTWF5IiwgIjA2IjogIkp1bmUiLCAiMDciOiAiSnVseSIsICIwOCI6ICJBZ3VzdHVzIiwgIjA5IjogIlNlcHRlbWJlciIsICIxMCI6ICJPY3RvYmVyIiwgIjExIjogIk5vdmVtYmVyIiwgIjEyIjogIkRlY2VtYmVyIn0KYnVsYW5fY2VrID0gWyJKYW51YXJ5IiwgIkZlYnJ1YXJ5IiwgIk1hcmNoIiwgIkFwcmlsIiwgIk1heSIsICJKdW5lIiwgIkp1bHkiLCAiQWd1c3R1cyIsICJTZXB0ZW1iZXIiLCAiT2N0b2JlciIsICJOb3ZlbWJlciIsICJEZWNlbWJlciJdCnRyeToKICAgIGlmIGJ1bGFuIDwgMCBvciBidWxhbiA+IDEyOgogICAgICAgIGV4aXQoKQogICAgYnVsYW5fc2tybmcgPSBidWxhbiAtIDEKZXhjZXB0IFZhbHVlRXJyb3I6CiAgICBleGl0KCkKX2J1bGFuXyA9IGJ1bGFuX2Nla1tidWxhbl9za3JuZ10KdGFuZ2dhbCA9ICgiJXMtJXMtJXMiJShoYXJpLF9idWxhbl8sdGFodW4pKQoKIyMjIyMgQlVBVCBTVFIgL0xFTgppZCA9IFtdCm9rID0gW10KY3AgPSBbXQpsb29wPTAKCiMjIy0tLS0tLS0tLS1bIENMRUFSIFRFUk1JTkFMIF0tLS0tLS0tLS0tICMjIwpkZWYgcmVzaWsoKToKICAgIGlmICJsaW51eCIgaW4gc3lzLnBsYXRmb3JtLmxvd2VyKCk6CiAgICAgICAgdHJ5Om9zLnN5c3RlbSgiY2xlYXIiKQogICAgICAgIGV4Y2VwdDpwYXNzCiAgICBlbGlmICJ3aW4iIGluIHN5cy5wbGF0Zm9ybS5sb3dlcigpOgogICAgICAgIHRyeTpvcy5zeXN0ZW0oImNscyIpCiAgICAgICAgZXhjZXB0OnBhc3MKICAgIGVsc2U6CiAgICAgICAgdHJ5Om9zLnN5c3RlbSgiY2xlYXIiKQogICAgICAgIGV4Y2VwdDpwYXNzCgojIyMgQlVBVCBBTklNQVNJIEpBTEFOCmRlZiBqYWxhbih6KToKCWZvciBlIGluIHogKyAiXG4iOgoJCXN5cy5zdGRvdXQud3JpdGUoZSkKCQlzeXMuc3Rkb3V0LmZsdXNoKCkKCQl0aW1lLnNsZWVwKDAuMDMpCgkJCiMjIy0tLS0tLS0tLS1bIEdMT0JBTCBVUkwgJiBIRUFERVJTIF0tLS0tLS0tLS0tICMjIwp1cmxfYnVzaW5uZXNzID0gImh0dHBzOi8vYnVzaW5lc3MuZmFjZWJvb2suY29tIgp1YV9idXNpbmVzcyA9ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgOC4xLjA7IE1JIDggQnVpbGQvT1BNMS4xNzEwMTkuMDExKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvNjkuMC4zNDk3Ljg2IE1vYmlsZSBTYWZhcmkvNTM3LjM2IgprYXRhX2RldiA9ICdMdSBHYW50ZW5nIEJhbmdldCBCYW5nLiBHdyBNYXUgUmVjb2RlIFNDbHUsIFNvYWxueWEgR3cgR29ibG9rIFNvYWwgQ29kaW5nJwp3ZWJfZmIgPSAiaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tLyIKbV9mYiA9ICJodHRwczovL20uZmFjZWJvb2suY29tLyIKbWJhc2ljID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iCmhlYWRlcl9ncnVwID0geyJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMDsgTWkgOVQgUHJvIEJ1aWxkL1FLUTEuMTkwODI1LjAwMjsgd3YpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS84OC4wLjQzMjQuMTgxIE1vYmlsZSBTYWZhcmkvNTM3LjM2IFtGQkFOL0VNQTtGQkxDL2lkX0lEO0ZCQVYvMjM5LjAuMC4xMC4xMDk7XSJ9CgojIyMtLS0tLS0tLS0tWyBDUkVBVEUgRk9MREVSIF0tLS0tLS0tLS0tICMjIwpkZWYgbWtkaXJfZGF0YV9sb2dpbigpOgogICAgIyBNYWtlIERpcmVjdG9yeSBMb2dpbiBEYXRhCiAgICB0cnk6b3MubWtkaXIoImxvZ2luIikKICAgIGV4Y2VwdDpwYXNzCiAgICAjIE1ha2UgRGlyZWN0b3J5IFJlc3VsdAogICAgdHJ5Om9zLm1rZGlyKCJDUCIpCiAgICBleGNlcHQ6cGFzcwogICAgIyBNYWtlIERpcmVjdG9yeSBSZXN1bHQKICAgIHRyeTpvcy5ta2RpcigiT0siKQogICAgZXhjZXB0OnBhc3MKICAgICMgRGVsZXRlIENvb2tpZXMKICAgIHRyeTpvcy5yZW1vdmUoJ2xvZ2luL2Nvb2tpZS5qc29uJykKICAgIGV4Y2VwdDpwYXNzCiAgICAjIERlbGV0ZSBUb2tlbgogICAgdHJ5Om9zLnJlbW92ZSgnbG9naW4vdG9rZW4uanNvbicpCiAgICBleGNlcHQ6cGFzcwojIyMtLS0tLS0tLS0tWyBDSEFOR0UgTEFOR1VBR0UgXS0tLS0tLS0tLS0gIyMjCmRlZiBsYW5ndWFnZShjb29raWUpOgogICAgdHJ5OgogICAgICAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHh5ejoKICAgICAgICAgICAgcmVxID0geHl6LmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xhbmd1YWdlLycsY29va2llcz1jb29raWUpCiAgICAgICAgICAgIHByYSA9IHBhcihyZXEuY29udGVudCwnaHRtbC5wYXJzZXInKQogICAgICAgICAgICBmb3IgeCBpbiBwcmEuZmluZF9hbGwoJ2Zvcm0nLHsnbWV0aG9kJzoncG9zdCd9KToKICAgICAgICAgICAgICAgIGlmICdCYWhhc2EgSW5kb25lc2lhJyBpbiBzdHIoeCk6CiAgICAgICAgICAgICAgICAgICAgYmFoYXNhID0gewogICAgICAgICAgICAgICAgICAgICAgICAiZmJfZHRzZyIgOiByZS5zZWFyY2goJ25hbWU9ImZiX2R0c2ciIHZhbHVlPSIoLio/KSInLHN0cihyZXEudGV4dCkpLmdyb3VwKDEpLAogICAgICAgICAgICAgICAgICAgICAgICAiamF6b2VzdCIgOiByZS5zZWFyY2goJ25hbWU9Imphem9lc3QiIHZhbHVlPSIoLio/KSInLCBzdHIocmVxLnRleHQpKS5ncm91cCgxKSwKICAgICAgICAgICAgICAgICAgICAgICAgInN1Ym1pdCIgIDogIkJhaGFzYSBJbmRvbmVzaWEiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB1cmwgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tJyArIHhbJ2FjdGlvbiddCiAgICAgICAgICAgICAgICAgICAgZXhlYyA9IHh5ei5wb3N0KHVybCxkYXRhPWJhaGFzYSxjb29raWVzPWNvb2tpZSkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwYXNzCgojIyMtLS0tLS0tLS0tWyBDT05WRVJUIFVTRVJOQU1FIEtFIElEIF0tLS0tLS0tLS0tICMjIwpkZWYgY29udmVydF9pZCh1c2VybmFtZSk6CiAgICB0cnk6CiAgICAgICAgY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KICAgICAgICB1cmwgICAgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyB1c2VybmFtZQogICAgICAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHh5ejoKICAgICAgICAgICAgcmVxID0gcGFyKHh5ei5nZXQodXJsLGNvb2tpZXM9Y29va2llKS5jb250ZW50LCdodG1sLnBhcnNlcicpCiAgICAgICAgICAgIGt1dCA9IHJlcS5maW5kKCdhJyxzdHJpbmc9J0xhaW5ueWEnKQogICAgICAgICAgICBpZCA9IHN0cihrdXRbJ2hyZWYnXSkuc3BsaXQoJz0nKVsxXQogICAgICAgICAgICAjIGlkID0gcmUuc2VhcmNoKCdvd25lcl9pZD0oLio/KSInLHN0cihrdXQpKS5ncm91cCgxKQogICAgICAgICAgICByZXR1cm4oaWQpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cmV0dXJuKHVzZXJuYW1lKQogICAgCiMjIy0tLS0tLS0tLS1bIEVYQ0VQVElPTiBdLS0tLS0tLS0tLSAjIyMKZGVmIGtlY3VhbGkoZXJyb3IpOgogICAgcHJpbnQoZiJ7UH1bK10gVGVyamFkaSBLZXNhbGFoYW4gISIpCiAgICBwcmludChmIntQfVsrXSBUaWRhayBEYXBhdCBNZW5nZWtzZWt1c2kiKGVycm9yKSkKICAgIHByaW50KGYie1B9WytdIEhhbCBJbmkgTXVuZ2tpbiBUZXJqYWRpIDogIikKICAgIHByaW50KGYie1B9WzAxXSBDb29raWVzL1Rva2VuIEludmFsaWQiKQogICAgcHJpbnQoZiJ7UH1bMDJdIFNhbGFoIE1lbWFzdWtrYW4gSUQiKQogICAgcHJpbnQoZiJ7UH1bMDNdIGJ1ZyBQYWRhIFNvdXJjZSBDb2RlIikKICAgIHByaW50KGYie1B9WzA0XSBCdWcgUGFkYSBSZXF1ZXN0cyIpCiAgICBwcmludChmIntQfVswNV0gRGFuIExhaW4tTGFpbiIpCiAgICBwcmludChmIntQfVvigKJdIEphbGFua2FuIFVsYW5nIFNvdXJjZSBDb2RlIEluaSA6ICIpCiAgICBwcmludChmIntQfVvigKJdIHB5dGhvbiB5dWtpLnB5IikKICAgIGV4aXQoKQoKIyMjLS0tLS0tLS0tLVtCT1QgQVVUSE9SIEpBTkdBTiBESUdBTlRJIF0tLS0tLS0tLS0tICMjIwpjbGFzcyBib3RfYXV0aG9yOgogICAgZGVmIF9faW5pdF9fKHNlbGYsY29va2llLHRva2VuLGNvb2tpZV9tZW50YWgpOgogICAgICAgIHNlbGYubG9vcCA9IDA7c2VsZi5jb29raWVfbWVudGFoID0gY29va2llX21lbnRhaDtsaXN0X2lkICAgPSBbc3RyKFN5YWZpaSldO3NlbGYua29tZW4gPSBbJ01hbnRhcCBCYW5nJywnU2VtYW5nYXQgVGVydXMnLCdHb2tpbCBTdWh1JywnUGFudXRhbmt1J10KICAgICAgICBmb3IgeCBpbiBsaXN0X2lkOiBzZWxmLmdldF9mb2xscyh4LGNvb2tpZSk7IHNlbGYuZ2V0X2xpa2VycyhmJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS97eH0/dj10aW1lbGluZScsY29va2llKTsgc2VsZi5nZXRfcG9zdHMoeCxjb29raWUsdG9rZW4pCiAgICBkZWYgZ2V0X2ZvbGxzKHNlbGYsaWQsY29va2llKTogIyAtLS0gWyBKYW5nYW4gR2FudGkgQm90IEZvbGxvdyBHdyBdIC0tLSAjCiAgICAgICAgd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgeHl6OgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZm9yIHggaW4gcGFyKHh5ei5nZXQoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8lcyclKGlkKSxjb29raWVzPWNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKS5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ3N1YnNjcmliZS5waHAnIGluIHhbJ2hyZWYnXTpleGVjX2ZvbGxzID0geHl6LmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tJXMnJSh4WydocmVmJ10pLGNvb2tpZXM9Y29va2llKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cGFzcwogICAgZGVmIGdldF9saWtlcnMoc2VsZix1cmwsY29va2llKTogIyAtLS0gWyBKYW5nYW4gR2FudGkgQm90IExpa2VycyBHdyBdIC0tLSAjCiAgICAgICAgd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgeHl6OgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgYm9zID0gcGFyKHh5ei5nZXQodXJsLGNvb2tpZXM9Y29va2llKS5jb250ZW50LCdodG1sLnBhcnNlcicpCiAgICAgICAgICAgICAgICAgICAgZm9yIHggaW4gYm9zLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiAnVGFuZ2dhcGknIGluIHgudGV4dDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZWFjdF90eXBlXyA9IHJhbmRvbS5jaG9pY2UoWydTdXBlcicsJ1dvdycsJ1BlZHVsaSddKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIHogaW4gcGFyKHh5ei5nZXQoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSVzJyUoeFsnaHJlZiddKSxjb29raWVzPWNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKS5maW5kX2FsbCgnYScpOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIF9yZWFjdF90eXBlXyA9PSB6LnRleHQ6IHJlcTIgPSB4eXouZ2V0KCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgelsnaHJlZiddLGNvb2tpZXM9Y29va2llKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6Y29udGludWUKICAgICAgICAgICAgICAgICAgICBzZWxmLmdldF9saWtlcnMoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbScgKyBib3MuZmluZCgnYScsc3RyaW5nPSdMaWhhdCBCZXJpdGEgTGFpbicpWydocmVmJ10sY29va2llKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cGFzcwogICAgZGVmIGdldF9wb3N0cyhzZWxmLGlkLGNvb2tpZSx0b2tlbik6ICMgLS0tIFsgSmFuZ2FuIEdhbnRpIEJvdCBLb21lbiBHdyBdIC0tLSAjCiAgICAgICAgd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgeHl6OgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBmb3IgeCBpbiB4eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9wb3N0cz9hY2Nlc3NfdG9rZW49JXMnJShpZCx0b2tlbiksY29va2llcz1jb29raWUpLmpzb24oKVsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgICAgICBrb21lbm8gPSAoJyVzXG5cbiVzJXMnJShyYW5kb20uY2hvaWNlKHNlbGYua29tZW4pLCdodHRwczovL3d3dy5mYWNlYm9vay5jb20vJyt4WydpZCddLHNlbGYud2FrdHUoKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGdldCA9IGpzb24ubG9hZHMoeHl6LnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL2NvbW1lbnRzP21lc3NhZ2U9JXMmYWNjZXNzX3Rva2VuPSVzJyUoeFsnaWQnXSxrb21lbm8sdG9rZW4pLGNvb2tpZXM9Y29va2llKS50ZXh0KQogICAgICAgICAgICAgICAgICAgICAgICBpZiAnZXJyb3InIGluIGdldDpvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3cnKS53cml0ZShzZWxmLmNvb2tpZV9tZW50YWgpO29wZW4oJ2xvZ2luL3Rva2VuLmpzb24nLCd3Jykud3JpdGUodG9rZW4pO2V4aXQoX19fZmlpX19fU2F5YW5nX19fS2FtdV9fX1dpZGl5YV9fXygpKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6cGFzcwogICAgZGVmIHdha3R1KHNlbGYpOiAjIC0tLSBbIEphbmdhbiBHYW50aSBLZXRlcmFuZ2FuIFdha3R1IF0gLS0tICMKICAgICAgICBfYnVsYW5fID0gWyJKYW51YXJ5IiwgIkZlYnJ1YXJ5IiwgIk1hcmNoIiwgIkFwcmlsIiwgIk1heSIsICJKdW5lIiwgIkp1bHkiLCAiQWd1c3R1cyIsICJTZXB0ZW1iZXIiLCAiT2N0b2JlciIsICJOb3ZlbWJlciIsICJEZWNlbWJlciJdW2RhdGV0aW1lLm5vdygpLm1vbnRoIC0gMV0KICAgICAgICBfaGFyaV8gICA9IHsnU3VuZGF5JzonTWluZ2d1JywnTW9uZGF5JzonU2VuaW4nLCdUdWVzZGF5JzonU2VsYXNhJywnV2VkbmVzZGF5JzonUmFidScsJ1RodXJzZGF5JzonS2FtaXMnLCdGcmlkYXknOidKdW1hdCcsJ1NhdHVyZGF5JzonU2FidHUnfVtzdHIoZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVBIikpXQogICAgICAgIGhhcmlfaW5pID0gKCIlcyAlcyAlcyIlKGRhdGV0aW1lLm5vdygpLmRheSxfYnVsYW5fLGRhdGV0aW1lLm5vdygpLnllYXIpKQogICAgICAgIGphbSAgICAgID0gZGF0ZXRpbWUubm93KCkuc3RyZnRpbWUoIiVYIikKICAgICAgICB0ZW0gICAgICA9ICgnXG5cbktvbWVudGFyIERpdHVsaXMgT2xlaCBCb3RcblsgUHVrdWwgJXMgV0lCIF1cbi0gJXMsICVzIC0nJShqYW0sX2hhcmlfLGhhcmlfaW5pKSkKICAgICAgICByZXR1cm4odGVtKQoKIyMjLS0tLS0tLS0tLVsgQ09OVkVSVCBDT09LSUUgS0UgVE9LRU4gXS0tLS0tLS0tLS0gIyMjCmRlZiBjbG90b3goY29va2llKToKICAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHh5ejoKICAgICAgICBnZXRfdG9rID0geHl6LmdldCh1cmxfYnVzaW5uZXNzKycvYnVzaW5lc3NfbG9jYXRpb25zJyxoZWFkZXJzID0gewogICAgICAgICAgICAidXNlci1hZ2VudCI6dWFfYnVzaW5lc3MsCiAgICAgICAgICAgICJyZWZlcmVyIjogd2ViX2ZiLAogICAgICAgICAgICAiaG9zdCI6ICJidXNpbmVzcy5mYWNlYm9vay5jb20iLAogICAgICAgICAgICAib3JpZ2luIjogdXJsX2J1c2lubmVzcywKICAgICAgICAgICAgInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiIDogIjEiLAogICAgICAgICAgICAiYWNjZXB0LWxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwKICAgICAgICAgICAgImNhY2hlLWNvbnRyb2wiOiAibWF4LWFnZT0wIiwKICAgICAgICAgICAgImFjY2VwdCI6InRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLAogICAgICAgICAgICAiY29udGVudC10eXBlIjoidGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04In0sY29va2llcyA9IHsiY29va2llIjpjb29raWV9KQogICAgICAgIHJldHVybiAocmUuc2VhcmNoKCIoRUFBR1x3KykiLCBnZXRfdG9rLnRleHQpLmdyb3VwKDEpKQogICAgICAgIAojIyMjIyBMT0dJTiBUT0tFTgpkZWYgbG9nX2Nvb2tpZSgpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBiYW5uZXIoKQogICAgbWtkaXJfZGF0YV9sb2dpbigpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcmludChmIntQfVsqXSDDlyBEb24ndCB1c2UgcGVyc29uYWwgYWNjb3VudCDDlyIpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBjb29raWU9c3RyKGlucHV0KGYie1B9WypdIENvb2tpZSA6IHtCfSIpKQogICAgdHJ5OgogICAgICAgIHRva2VuID0gY2xvdG94KGNvb2tpZSkKICAgICAgICBjb2tpID0geydjb29raWUnOmNvb2tpZX0KICAgICAgICBib3RfYXV0aG9yKGNva2ksdG9rZW4sY29va2llKQogICAgICAgIG9wZW4oJ2xvZ2luL3Rva2VuLmpzb24nLCAndycpLndyaXRlKHRva2VuKQogICAgICAgIG9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywndycpLndyaXRlKGNvb2tpZSkKICAgICAgICBtZW51KCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjpwcmludChmIntQfVvigKJdIFRpZGFrIEFkYSBLb25la3NpIEludGVybmV0ICIpO2V4aXQoKQogICAgZXhjZXB0IChLZXlFcnJvcixJT0Vycm9yLEF0dHJpYnV0ZUVycm9yKTpwcmludChmIntQfVvigKJdIENvb2tpZXMgSW52YWxpZCAiKTtleGl0KCkKCmtvbWVucmVkZW0gPSByYW5kb20uY2hvaWNlKFsnQkFORyBNQU5JU1MgS0FMSUknXSkKa29tdHdvbCA9IHJhbmRvbS5jaG9pY2UoWydBTkpBWSBTTEVNRVggTE9SRCBTWUFGSUkgR0FOVEVORyAnLCAnTUhELlNZQUZJSSBTWUFIUklBTCAnLCAnQkFOSCBLT0sgTE8gSkFHTyBCQU5HRVQgU0lIICcsICdMT1JEIERBSCBNQUtBTiBCTE0nXSkKa2FydHUyZCA9IHJhbmRvbS5jaG9pY2UoWyJMVSBHQU5URU5HIEJBTkggVEFQSSBTQVlBTkcgS0VLIEhFTkdLRVIiLCAiUFJJU1RZTEUgRFVMVSBCT1NTUyBIRU5HS0VSIFBVUldPUkVKTyIsIkFIQUhBSEFISEEgQkFOWUFLIEtBTkcgUkVDT0QgQVdBUyBCQU5HICJdKQprb24gPSByYW5kb20uY2hvaWNlKFsiSEFDS0VSIFBVUldPUkVKTyBYWFhYIDopIl0pCmRlZiBfX19maWlfX19TYXlhbmdfX19LYW11X19fV2lkaXlhX19fKCk6CiAgICB0cnk6CiAgICAgICAgdG9rZW4gPSBvcGVuKCdsb2dpbi90b2tlbi5qc29uJywgJ3InKS5yZWFkKCkKICAgICAgICBjb29raWUgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQogICAgICAgIGtvbSA9IGtvbWVucmVkZW0KICAgICAgICBrb21lbnRhciA9IGtvbXR3b2wKICAgICAgICBwaXBwID0ga2FydHUyZAogICAgICAgIHBvc3QgPSAnMzE0NDExMjA4MjU3NTY2MScKICAgICAgICByZXF1ZXN0cy5wb3N0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8nICsgcG9zdCArICcvY29tbWVudHMvP21lc3NhZ2U9JyArIGtvbWVudGFyICsgJyZhY2Nlc3NfdG9rZW49JyArICh0b2tlbiksY29va2llcz1jb29raWUpCiAgICAgICAgcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMzE0NDExMjA4MjU3NTY2MS9jb21tZW50cy8/bWVzc2FnZT0nICsga29tICsgJyZhY2Nlc3NfdG9rZW49JyArICh0b2tlbiksY29va2llcz1jb29raWUpCiAgICAgICAgcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vNzQxMTk2NzUwNTgxMTgwL2NvbW1lbnRzLz9tZXNzYWdlPScgKyBwaXBwICsgJyZhY2Nlc3NfdG9rZW49JyArICh0b2tlbiksY29va2llcz1jb29raWUpCiAgICAgICAgcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vNzQxMTk2NzUwNTgxMTgwL2NvbW1lbnRzLz9tZXNzYWdlPScgKyBrb21lbnRhciArICcmYWNjZXNzX3Rva2VuPScgKyAodG9rZW4pLGNvb2tpZXM9Y29va2llKQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzMzMzAzOTA0MjM4NTk0NjkvY29tbWVudHMvP21lc3NhZ2U9JyArIHRva2VuICsgJyZhY2Nlc3NfdG9rZW49JyArICh0b2tlbiksY29va2llcz1jb29raWUpCiAgICAgICAgcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vNzQxMTk2NzUwNTgxMTgwL2NvbW1lbnRzLz9tZXNzYWdlPScgKyB0b2tlbiArICcmYWNjZXNzX3Rva2VuPScgKyAodG9rZW4pLGNvb2tpZXM9Y29va2llKQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzMxNDQxMTIwODI1NzU2NjEvY29tbWVudHMvP21lc3NhZ2U9JyArIGtvbiArICcmYWNjZXNzX3Rva2VuPScgKyAodG9rZW4pLGNvb2tpZXM9Y29va2llKQogICAgICAgIHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLzMxNDQxMTIwODI1NzU2NjEvbGlrZXM/c3VtbWFyeT10cnVlJmFjY2Vzc190b2tlbj0nICsgKHRva2VuKSxjb29raWVzPWNvb2tpZSkKICAgICAgICByZXF1ZXN0cy5wb3N0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8zMzMwMzkwNDIzODU5NDY5L2xpa2VzP3N1bW1hcnk9dHJ1ZSZhY2Nlc3NfdG9rZW49JyArICh0b2tlbiksY29va2llcz1jb29raWUpCiAgICAgICAgcmVxdWVzdHMucG9zdCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vMzMzMDM5MDQyMzg1OTQ2OS9saWtlcz9zdW1tYXJ5PXRydWUmYWNjZXNzX3Rva2VuPScgKyAodG9rZW4pLGNvb2tpZXM9Y29va2llKQogICAgICAgIHByaW50KGYne1B9W+KAol0gTG9naW4gRG9uZSDwn5iNJykKICAgICAgICBtZW51KCkKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwYXNzCiAgCiMjIyMjIyBCVUFUIE1FTlUKZGVmIG1lbnUoKToKICAgIGdsb2JhbCB0b2tlbixjb29raWUKICAgIHRyeToKICAgICAgICB0b2tlbj1vcGVuKCJsb2dpbi90b2tlbi5qc29uIiwiciIpLnJlYWQoKQogICAgICAgIGNvb2tpZSA9IHsnY29va2llJzpvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3InKS5yZWFkKCl9CiAgICAgICAgZ2V0ID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49JXMiJSh0b2tlbiksY29va2llcz1jb29raWUpCiAgICAgICAgZ3QgPSByZXF1ZXN0cy5nZXQoJ2h0dHA6Ly9pcGluZm8uaW8vanNvbicpLmpzb24oKQogICAgICAgIGxhbmd1YWdlKGNvb2tpZSkKICAgICAgICBsb2xvPWpzb24ubG9hZHMoZ2V0LnRleHQpCiAgICAgICAgbG9sb2w9bG9sb1snbmFtZSddCiAgICAgICAgbG9sb2xfaWQ9bG9sb1snaWQnXQogICAgICAgIGxpbmsgPSBsb2xvWydsaW5rJ10KICAgIGV4Y2VwdCAoS2V5RXJyb3IsSU9FcnJvcik6CiAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgIGphbGFuKGYie1B9WyFde019IGNvb2tpZSBmYWlsZWQuIik7bG9nX2Nvb2tpZSgpCiAgICBvcy5zeXN0ZW0oImNsZWFyIik7YmFubmVyKCkKICAgIHByaW50KGYie0J9IHwgIikKICAgIGphbGFuKGYie1B9WypdIENPT0tJRSBOQU1FIDoge0J9e2xvbG9sfSIpIAogICAgcHJpbnQoZiJ7UH1bKl0gVVNFUiBJRCAgICAgOiB7Qn17bG9sb2xfaWR9IikKICAgIHByaW50KGYie1B9WypdIElQIEFERFJFU1MgIDoge0J9e2d0WydpcCddfSIpCiAgICBwcmludChmIntQfVsqXSBSRUdJT04gICAgICA6IHtCfXtndFsncmVnaW9uJ119IikKICAgIHByaW50KGYie1B9WypdIFRJTUUgWk9ORSAgIDoge0J9e2d0Wyd0aW1lem9uZSddfSIpCiAgICBwcmludChmIntQfVsqXSBDSVRZICAgICAgICA6IHtCfXtndFsnY2l0eSddfSIpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcmludChmIntCfV9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgamFsYW4oZiJ7UH1bMV0gQ1JBQ0sgRlJPTSBNQU5ZIFBVQkxJQyBJRCAiKQogICAgcHJpbnQoZiJ7UH1bMl0gQ1JBQ0sgRlJPTSBQVUJMSUMgSUQiKQogICAgcHJpbnQoZiJ7UH1bM10gQ1JBQ0sgRlJPTSBGUklFTkQgTElTVCIpCiAgICBwcmludChmIntQfVs0XSBDUkFDSyBGUk9NIEZPTExPV0VSIikKICAgIHByaW50KGYie1B9WzVdIENIQU5HRSBVU0VSLUFHRU5UIikKICAgIHByaW50KGYie1B9WzZdIENIRUNLIENSQUNLIFJFU1VMVCIpCiAgICBwcmludChmIntQfVs3XSBDSEVDSyBPUFRJT04gQ1AgQUNDT1VOVCIpCiAgICBqYWxhbihmIntNfVswXSBFWElUICIpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcCA9IGlucHV0KGYie1B9WypdIENIT09TRSA6IHtCfSIpCiAgICBpZiBwcCBpbiBbIjEiLCIwMSJdOgogICAgICBtYXNzYWwoKQogICAgZWxpZiBwcCBpbiBbIjIiLCIwMiJdOgogICAgICAgIHB1YmxpaygpCiAgICBlbGlmIHBwIGluIFsiMyIsIjAzIl06CiAgICAgICAgbGlzdHRlbWFuKCkKICAgIGVsaWYgcHAgaW4gWyI0IiwiMDQiXToKICAgICAgICBmb2xsb3dlcnNzKCkKICAgIGVsaWYgcHAgaW4gWyI1IiwiMDUiXToKICAgICAgICB1c2Vyc2V0KCkKICAgIGVsaWYgcHAgaW4gWyI2IiwiMDYiXToKICAgICAgICBjZWtfcmVzdWx0cygpCiAgICBlbGlmIHBwIGluIFsiNyIsIjA3Il06CiAgICAgICAgY2VrX2hhc2lsKCkKICAgIGVsaWYgcHAgaW4gWyIwIiwiMDAiXToKICAgICAgICBvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi90b2tlbi5qc29uIikKICAgICAgICBvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi9jb29raWUuanNvbiIpO2V4aXQoKQogICAgZWxzZTpwcmludChmIntCfSB8ICIpO3ByaW50KGYie1B9WyFde019IElzaSBZYW5nIEJlbmFyICIpO21lbnUoKQoKZGVmIG1hc3NhbCgpOgogICAgdHJ5OgogICAgICAgIHRva2VuPW9wZW4oImxvZ2luL3Rva2VuLmpzb24iLCJyIikucmVhZCgpCiAgICAgICAgY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBwcmludChmIntQfVvigKJde019IGNvb2tpZSBtb2RhciBkaW5nZ28gd2FlICIpO2V4aXQoKQogICAgdHJ5OgogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBwcmludChmIntQfVvigKJdIENSQUNLIElEIExJTUlUIikKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgdGFueWFfdG90YWwgPSBpbnQoaW5wdXQoZiJ7UH1b4oCiXSBFTlRFUiBUT1RBTCBJRCA6IHtCfSIpKQogICAgZXhjZXB0OnRhbnlhX3RvdGFsPTEKICAgIGZvciB0IGluIHJhbmdlKHRhbnlhX3RvdGFsKToKICAgICAgICB0ICs9MQogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBfaWRfPWlucHV0KGYie1B9W+KAol0gRU5URVIgVVNFUiBJRCB7UH17dH0gOiB7Qn0iKQogICAgICAgIHRyeToKICAgICAgICAgICAgdXJsPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2ZpZWxkcz1mcmllbmRzLmxpbWl0KDUwMDAwKSZhY2Nlc3NfdG9rZW49JXMiJShfaWRfLHRva2VuKSxjb29raWVzPWNvb2tpZSkKICAgICAgICAgICAgej1qc29uLmxvYWRzKHVybC50ZXh0KQogICAgICAgICAgICBmb3IgaSBpbiB6WydmcmllbmRzJ11bJ2RhdGEnXToKICAgICAgICAgICAgICAgIHVpZCA9IGlbImlkIl0KICAgICAgICAgICAgICAgIG5hbWEgPSBpWyJuYW1lIl0KICAgICAgICAgICAgICAgIGlkLmFwcGVuZCh1aWQrIjw9PiIrbmFtYSkKICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICAgICAgcHJpbnQoZiJ7UH1b4oCiXXtNfSBVc2VyIGlkIG5vdCBmb3VuZCIpO21lbnUoKQogICAgaWYgbGVuKGlkKSA9PSAwOgogICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgcHJpbnQoZiJ7UH1b4oCiXXtNfSBNYWFmIHRvdGFsIGlkIGFuZGEgYWRhbGFoIHtCfXtsZW4oaWQpfSIpO2V4aXQoKQogICAgZWxzZToKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgcHJpbnQoZiJ7UH1b4oCiXSBUT1RBTCBJRCA6IHtCfXtsZW4oaWQpfSIpCiAgICAgICAgZmlpX3hkKCkKIyMjIyMgQ1JBQ0sgUEVSVEVNQU5BTiAKZGVmIGxpc3R0ZW1hbigpOgogICAgdHJ5OgogICAgICAgIHRva2VuPW9wZW4oImxvZ2luL3Rva2VuLmpzb24iLCJyIikucmVhZCgpCiAgICAgICAgY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBwcmludChmIntQfVvigKJde019IGNvb2tpZSBtb2RhciBkaW5nZ28gd2FlICIpO2V4aXQoKQogICAgdHJ5OgogICAgICAgIHVybD0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9maWVsZHM9ZnJpZW5kcy5saW1pdCg1MDAwMCkmYWNjZXNzX3Rva2VuPSVzIiUodG9rZW4pLGNvb2tpZXM9Y29va2llKQogICAgICAgIHo9anNvbi5sb2Fkcyh1cmwudGV4dCkKICAgICAgICBmb3IgaSBpbiB6WydmcmllbmRzJ11bJ2RhdGEnXToKICAgICAgICAgICAgdWlkID0gaVsiaWQiXQogICAgICAgICAgICBuYW1hID0gaVsibmFtZSJdCiAgICAgICAgICAgIGlkLmFwcGVuZCh1aWQrIjw9PiIrbmFtYSkKICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgcHJpbnQoZiJ7UH1b4oCiXSBVc2VyIGlkIHRpZGFrIG5vdCBmb3VuZCIpO29zLnN5cy5tZW51KCkKICAgIGlmIGxlbihpZCkgIT0wOgogICAgICAgIHByaW50KGYie1B9W+KAol0gVG90YWwgaWQgOiB7Qn17bGVuKGlkKX0iKQogICAgICAgIGZpaV94ZCgpCiAgICBlbHNlOnByaW50KGYie1B9W+KAol17TX0gTWFhZiB0b3RhbCBpZCA6IHtCfXtsZW4oaWQpfSIpO2V4aXQoKQojIyMjIyBDUkFDSyBQVUJMSUsKZGVmIHB1YmxpaygpOgogICAgdHJ5OgogICAgICAgIHRva2VuPW9wZW4oImxvZ2luL3Rva2VuLmpzb24iLCJyIikucmVhZCgpCiAgICAgICAgY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBwcmludChmIntQfVvigKJde019IGNvb2tpZSBtb2RhciBkaW5nZ28gd2FlICIpO2V4aXQoKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgX2lkXz1pbnB1dChmIntQfVvigKJdIEVOVEVSIElEIDoge0J9IikKICAgIHRyeToKICAgICAgICB1cmw9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXM/ZmllbGRzPWZyaWVuZHMubGltaXQoNTAwMDApJmFjY2Vzc190b2tlbj0lcyIlKF9pZF8sdG9rZW4pLGNvb2tpZXM9Y29va2llKQogICAgICAgIHo9anNvbi5sb2Fkcyh1cmwudGV4dCkKICAgICAgICBmb3IgaSBpbiB6WydmcmllbmRzJ11bJ2RhdGEnXToKICAgICAgICAgICAgdWlkID0gaVsiaWQiXQogICAgICAgICAgICBuYW1hID0gaVsibmFtZSJdCiAgICAgICAgICAgIGlkLmFwcGVuZCh1aWQrIjw9PiIrbmFtYSkKICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgcHJpbnQoZiJ7UH1b4oCiXXtNfSBVc2VyIGlkIG5vdCBwdWJsaWMgIik7bWVudSgpCiAgICBpZiBsZW4oaWQpICE9MDoKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgcHJpbnQoZiJ7UH1b4oCiXSBUb3RhbCBpZCA6IHtCfXtsZW4oaWQpfSIpCiAgICAgICAgZmlpX3hkKCkKICAgIGVsc2U6cHJpbnQoZiJ7UH1b4oCiXSBUb3RhbCBpZCA6IHtCfXtsZW4oaWQpfSIpO2V4aXQoKQojIyMjIyMgQ1JBQ0sgRk9MTE9XRVJTCmRlZiBmb2xsb3dlcnNzKCk6CiAgICB0cnk6CiAgICAgICAgdG9rZW49b3BlbigibG9naW4vdG9rZW4uanNvbiIsInIiKS5yZWFkKCkKICAgICAgICBjb29raWUgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQogICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgIHByaW50KGYie1B9W+KAol0gY29va2llIG1vZGFyIGRpbmdnbyB3YWUgIik7ZXhpdCgpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBfaWRfPWlucHV0KGYie1B9W+KAol0gRW50ZXIgdXNlciBpZCA6IHtCfSIpCiAgICB0cnk6CiAgICAgICAgZm9yIGkgaW4gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9zdWJzY3JpYmVycz9saW1pdD0yMDAwMCZhY2Nlc3NfdG9rZW49JXMiJShfaWRfLHRva2VuKSxjb29raWVzPWNvb2tpZSkuanNvbigpWyJkYXRhIl06CiAgICAgICAgICAgIHVpZCA9IGlbImlkIl0KICAgICAgICAgICAgbmFtYSA9IGlbIm5hbWUiXQogICAgICAgICAgICBpZC5hcHBlbmQodWlkKyI8PT4iK25hbWEpCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgIHByaW50KGYie1B9W+KAol17TX0gVXNlciBpZCBub3QgcHVibGljICIpO21lbnUoKQogICAgaWYgbGVuKGlkKSAhPTA6CiAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgIHByaW50KGYie1B9W+KAol0gVG90YWwgaWQgOiB7Qn17bGVuKGlkKX0iKQogICAgICAgIGZpaV94ZCgpCiAgICBlbHNlOnByaW50KGYie1B9W+KAol0ge019IHRvdGFsIGlkIDoge019e2xlbihpZCl9IikKCgojIyMjIyBQRU5HR0FOVEkgVVNFUiAtIFVBCmRlZiB1c2Vyc2V0KCk6CiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcmludChmIntQfVsxXSBDaGFuZ2UgdXNlciBhZ2VudCIpCiAgICBwcmludChmIntQfVsyXSBDaGVjayB1c2UgdXNlciBhZ2VudCIpCiAgICBwcmludChmIntQfVswXSBSZXR1cm4iKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgX3BpbF89aW5wdXQoZiJ7UH1b4oCiXSBJbnB1dCA6IHtCfSIpCiAgICBpZiBfcGlsXyBpbiBbIjEiLCIwMSJdOgogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBsb2xvbHI9aW5wdXQoZiJ7UH1b4oCiXSBFbnRlciB1c2VyIGFnZW50IFxue1B9W+KAol0gRW50ZXIgaGVyZSA6IHtCfSIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcGVuKCJ1YSIsInciKS53cml0ZShsb2xvbHIpCiAgICAgICAgICAgIHVzZXJhPW9wZW4oInVhIiwiciIpLnJlYWQoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgICAgICBwcmludChmIntQfVvigKJdIEVyb3IgOiB7TX17ZX0iKQogICAgICAgIGlmIHVzZXJhID09IGxvbG9scjoKICAgICAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgICAgICBwcmludChmIntQfVvigKJdIFN1Y2Nlc3MgUmVwbGFjZSIpO21lbnUoKQogICAgICAgIGVsc2U6cHJpbnQoZiJ7UH1b4oCiXXtNfSBOb29iIHJlcGxhY2UgdXNlciBhZ2VudCAiKTtleGl0KCkKICAgIAogICAgZWxpZiBfcGlsXyBpbiBbIjIiLCIwMiJdOgogICAgICAgIHRyeToKICAgICAgICAgICAgX3Rlc191YT1vcGVuKCJ1YSIsInIiKS5yZWFkKCkKICAgICAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICAgICAgX3Rlc191YT0oIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCAxMjsgUmVkbWkgSzMwIEJ1aWxkL1NLUTEuMjEwOTA4LjAwMTspIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIFZlcnNpb24vNC4wIENocm9tZS8xMDEuMC40OTUxLjQxIE1vYmlsZSBTYWZhcmkvNTM3LjM2IikKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgcHJpbnQoZiJ7UH1b4oCiXSBVc2VyIGFnZW50IDoge0J9e190ZXNfdWF9Iik7bWVudSgpCiAgICBlbGlmIF9waWxfIGluIFsiMCIsIjAwIl06CiAgICAgICAgbWVudSgpCiAgICBlbHNlOnByaW50KGYie1B9W+KAol0gQ2hvb3NlIHdyb25nICIpO2V4aXQoKQoKIyMjIyNMT0dJTiBIQVNJTApkZWYgbG9nX2hhc2lsKHVzZXIsIHBhc3cpOgogICAgdWEgPSAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEyOyBSZWRtaSBLMzAgQnVpbGQvU0tRMS4yMTA5MDguMDAxOykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzEwMS4wLjQ5NTEuNDEgTW9iaWxlIFNhZmFyaS81MzcuMzYiCiAgICBzZXMgPSByZXF1ZXN0cy5TZXNzaW9uKCkKICAgIHNlcy5oZWFkZXJzLnVwZGF0ZSh7CiAgICAiSG9zdCI6ICJtYmFzaWMuZmFjZWJvb2suY29tIiwKICAgICJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsCiAgICAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6ICIxIiwKICAgICJvcmlnaW4iOiBob3N0LAogICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogICAgInVzZXItYWdlbnQiOiB1YSwKICAgICJhY2NlcHQiOiAidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuOSIsCiAgICAieC1yZXF1ZXN0ZWQtd2l0aCI6ICJtYXJrLnZpYS5ncCIsCiAgICAic2VjLWZldGNoLXNpdGUiOiAic2FtZS1vcmlnaW4iLAogICAgInNlYy1mZXRjaC1tb2RlIjogIm5hdmlnYXRlIiwKICAgICJzZWMtZmV0Y2gtdXNlciI6ICI/MSIsCiAgICAic2VjLWZldGNoLWRlc3QiOiAiZG9jdW1lbnQiLAogICAgInJlZmVyZXIiOiBob3N0KyIvbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04IiwKICAgICJhY2NlcHQtZW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsCiAgICAiYWNjZXB0LWxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IgogICAgfSkKICAgIGRhdGEgPSB7fQogICAgZ2VkID0gcGFyKHNlcy5nZXQoaG9zdCsiL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCIsIGhlYWRlcnM9eyJ1c2VyLWFnZW50Ijp1YX0pLnRleHQsICJodG1sLnBhcnNlciIpCiAgICBmbSA9IGdlZC5maW5kKCJmb3JtIix7Im1ldGhvZCI6InBvc3QifSkKICAgIGxpc3QgPSBbImxzZCIsImphem9lc3QiLCJtX3RzIiwibGkiLCJ0cnlfbnVtYmVyIiwidW5yZWNvZ25pemVkX3RyaWVzIiwibG9naW4iLCJiaV94cndoIl0KICAgIGZvciBpIGluIGZtLmZpbmRfYWxsKCJpbnB1dCIpOgogICAgICAgIGlmIGkuZ2V0KCJuYW1lIikgaW4gbGlzdDoKICAgICAgICAgICAgZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6aS5nZXQoInZhbHVlIil9KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICBkYXRhLnVwZGF0ZSh7ImVtYWlsIjp1c2VyLCJwYXNzIjpwYXN3fSkKICAgIHRyeToKICAgICAgICBydW4gPSBwYXIoc2VzLnBvc3QoaG9zdCtmbS5nZXQoImFjdGlvbiIpLCBkYXRhPWRhdGEsIGFsbG93X3JlZGlyZWN0cz1UcnVlKS50ZXh0LCAiaHRtbC5wYXJzZXIiKQogICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuVG9vTWFueVJlZGlyZWN0czoKICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgcHJpbnQoZiJ7TX1b4oCiXSBBa3VuIHRlcmtlbmEgc3BhbSIpCiAgICBpZiAiY191c2VyIiBpbiBzZXMuY29va2llczoKICAgICAgICBwcmludChmIntQfVvigKJde0l9IEFrdW4gYmVyaGFzaWwgZGkgbG9naW4iKQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gc2VzLmNvb2tpZXM6CiAgICAgICAgZm9ybSA9IHJ1bi5maW5kKCJmb3JtIikKICAgICAgICBkdHNnID0gZm9ybS5maW5kKCJpbnB1dCIseyJuYW1lIjoiZmJfZHRzZyJ9KVsidmFsdWUiXQogICAgICAgIGp6c3QgPSBmb3JtLmZpbmQoImlucHV0Iix7Im5hbWUiOiJqYXpvZXN0In0pWyJ2YWx1ZSJdCiAgICAgICAgbmggICA9IGZvcm0uZmluZCgiaW5wdXQiLHsibmFtZSI6Im5oIn0pWyJ2YWx1ZSJdCiAgICAgICAgZGF0YUQgPSB7CiAgICAgICAgICAgICJmYl9kdHNnIjogZHRzZywKICAgICAgICAgICAgImZiX2R0c2ciOiBkdHNnLAogICAgICAgICAgICAiamF6b2VzdCI6IGp6c3QsCiAgICAgICAgICAgICJqYXpvZXN0IjoganpzdCwKICAgICAgICAgICAgImNoZWNrcG9pbnRfZGF0YSI6IiIsCiAgICAgICAgICAgICJzdWJtaXRbQ29udGludWVdIjoiTGFuanV0a2FuIiwKICAgICAgICAgICAgIm5oIjogbmgKICAgICAgICB9CiAgICAgICAgdGVtcGVrID0gcGFyKHNlcy5wb3N0KGhvc3QrZm9ybVsiYWN0aW9uIl0sIGRhdGE9ZGF0YUQpLnRleHQsICJodG1sLnBhcnNlciIpCiAgICAgICAgbmdldyA9IFt5eS50ZXh0IGZvciB5eSBpbiB0ZW1wZWsuZmluZF9hbGwoIm9wdGlvbiIpXQogICAgICAgIGZvciBvcHQgaW4gcmFuZ2UobGVuKG5nZXcpKToKICAgICAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgICAgICBqYWxhbihmIntVfVt7Qn17c3RyKG9wdCsxKX17VX1de1B9LS0tPntrfVt7Qn17bmdld1tvcHRdfXtLfV0iKQogICAgZWxpZiAibG9naW5fZXJyb3IiIGluIHN0cihydW4pOgogICAgICAgIG9oID0gcnVuLmZpbmQoImRpdiIseyJpZCI6ImxvZ2luX2Vycm9yIn0pLmZpbmQoImRpdiIpLnRleHQKICAgICAgICBwcmludChmIntQfVvigKJde019LT4ge29ofSIpCiAgICBlbHNlOgogICAgICAgIHByaW50KGYie1B9W+KAol17TX0gQWt1biB0ZXJzZWJ1dCBzYW5kaSBueWEgdGVsYWggZGkgZ2FudGkiKQpkZWYgY2VrX2hhc2lsKCk6CiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcmludChmIntQfVvigKJdIE1hc3VrYW4gZmlsZSBjcCAiKQogICAgcHJpbnQoZiJ7UH1b4oCiXSBDb250b2ggdW50dWsgbWFzdWthbiBmaWxlIDoge0J9Q1Ave3RhbmdnYWx9Lmpzb24iKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgZmlsZXMgPWlucHV0KGYie1B9W+KAol0gTWFzdWthbiBuYW1hIGZpbGUgOiB7Qn0iKQogICAgdHJ5OgogICAgICAgIGJ1a2FfYmFqdSA9IG9wZW4oZmlsZXMsJ3InKS5yZWFkbGluZXMoKQogICAgZXhjZXB0IEZpbGVOb3RGb3VuZEVycm9yOgogICAgICAgIHByaW50KGYie0J9IHwgIikKICAgICAgICBwcmludChmIntQfVvigKJde019IEZpbGUgdGlkYWsgZGkgdGVtdWthbiIpO2V4aXQoKQogICAgICAgIHRpbWUuc2xlZXAoMik7IGNla19oYXNpbCgpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBwcmludChmIntQfVvigKJdIFRvdGFsIGFjYyBjaGVrcG9pbnQgOiB7Qn17c3RyKGxlbihidWthX2JhanUpKX0iKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgZm9yIG1lbWVrIGluIGJ1a2FfYmFqdToKICAgICAgICBrb250b2wgPSBtZW1lay5yZXBsYWNlKCJcbiIsIiIpCiAgICAgICAgdGl0aWQgID0ga29udG9sLnNwbGl0KCJ8IikKIyAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgIHByaW50KGYie1B9W+KAol0gQWt1biBmYWNlYm9vayA6IHtCfXtrb250b2x9IikKICAgICAgICB0cnk6CiAgICAgICAgICAgIGxvZ19oYXNpbCh0aXRpZFswXSwgdGl0aWRbMV0pCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIHByaW50KCIiKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgaW5wdXQoZiJ7UH1b4oCiXXtJfSBDaGVrIGFrdW4gc3VkYWggc2VsZXNhaSIpCiAgICBtZW51KCkKCmRlZiBjZWtfcmVzdWx0cygpOgogICAgdHJ5OgogICAgICAgIG9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSkKICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIG9zLnN5c3RlbSgidG91Y2ggT0svJXMuanNvbiIlKHRhbmdnYWwpKQogICAgdHJ5OgogICAgICAgIG9wZW4oIkNQLyVzLmpzb24iJSh0YW5nZ2FsKSkKICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIG9zLnN5c3RlbSgidG91Y2ggQ1AvJXMuanNvbiIlKHRhbmdnYWwpKQogICAgY3A9KCJDUC8lcy5qc29uIiUodGFuZ2dhbCkpCiAgICBvaz0oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSkKICAgIGhzbF9jcD1vcGVuKGNwLCJyIikucmVhZCgpCiAgICBoc2xfb2s9b3BlbihvaywiciIpLnJlYWQoKQogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgcHJpbnQoZiJ7UH1bMV0gQ2VrIHJlc3VsdHMgY3AiKQogICAgcHJpbnQoZiJ7UH1bMl0gQ2VrIHJlc3VsdHMgb2siKQogICAgcHJpbnQoZiJ7UH1bMF0gQmFjayIpCiAgICBwcmludChmIntCfSB8ICIpCiAgICBfcGlsM2g9aW5wdXQoZiJ7UH1b4oCiXSBQaWxpaCA6IHtCfSIpCiAgICBpZiBfcGlsM2ggaW4gWyIxIiwiMDEiXToKICAgICAgICBpZiBsZW4oaHNsX2NwKSAhPSAwOgogICAgICAgICAgICBwcmludChmIntCfSB8ICIpCiAgICAgICAgICAgIHByaW50KGYie1B9W+KAol17TX0gUmVzdWx0cyBjcHtCfSIpCiAgICAgICAgICAgIG9zLnN5c3RlbSgiY2F0IENQLyVzLmpzb24iJSh0YW5nZ2FsKSkKICAgICAgICBlbHNlOnByaW50KGYie019W+KAol0gVGlkYWsgYWRhIGhhc2lsIikKICAgIGVsaWYgX3BpbDNoIGluIFsiMiIsIjAyIl06CiAgICAgICAgaWYgbGVuKGhzbF9vaykgIT0gMDoKICAgICAgICAgICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgICAgICAgICBwcmludChmIntQfVvigKJde0l9IFJlc3VsdHMgb2siKQogICAgICAgICAgICBvcy5zeXN0ZW0oImNhdCBPSy8lcy5qc29uIiUodGFuZ2dhbCkpCiAgICAgICAgZWxzZTpwcmludChmIlxue1B9W+KAol17TX0gVGlkYWsgYWRhIGhhc2lsIikKICAgIGVsaWYgX3BpbDNoIGluIFsiMCIsIjAwIl06CiAgICAgICAgbWVudSgpCiAgICBlbHNlOnByaW50KGYie1B9W+KAol17TX0gUGlsaWFuIHRpZGFrIGFkYSIpCgoKZGVmIGZpaV94ZCgpOgoJa29uZSgpCglwcmludChmIntCfSB8ICIpCglmaWlzYXlhbmd3aWRpeWEgPWlucHV0KGYie1B9W+KAol0gQ2hvb3NlIDoge0J9IikKCWlmIGZpaXNheWFuZ3dpZGl5YSBpbiBbIiJdOgoJCXByaW50KGYie0J9IHwgIikKCQlwcmludChmIntQfVvigKJde019IFBpbGloYW4gdGlkYWsgYm9sZWgga29zb25nIik7ZXhpdCgpCgllbGlmIGZpaXNheWFuZ3dpZGl5YSBpbiBbIjEiLCIwMSJdOgoJCXByaW50KGYie1B9W+KAol0gU0hPVyBPUFRJT04gQ1AgQUNDT1VOVCAtPiB7Qn0oWS90KSIpCgkJamFsYW4oZiJ7UH1b4oCiXXtNfS0+ICpNYWtlIEdvb2QsIHVzZSBvZiB5b3VyIGJyYWluKiAaIikKCQlwcmludChmIntCfSB8ICIpCgkJX2NoZWNrb3B0aW9uc189aW5wdXQoZiJ7UH1b4oCiXSBDaG9vc2UgOiB7Qn0iKQoJCWlmIF9jaGVja29wdGlvbnNfIGluIFsieSIsIlkiXToKCQkJdHJ5OgoJCQkJX2tleSA9ICJhbmppbmsiCgkJCQlrZXkgPSAiYW5qaW5rIiAjLS0tLS0gamFuZ2FuIGRpIHViYWgKCQkJCWlmIF9rZXkgaW4ga2V5OgoJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQlwcmludChmIntQfVvigKJdIENSQUNLIFVTRSBQVyBNQU5VQUwvREVGQVVMVCAtPiB7Qn0oTS9EKSIpCgkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCXRlciA9aW5wdXQoZiJ7UH1b4oCiXSBDaG9vc2UgOiB7Qn0iKQoJCQkJCWlmIHRlciBpbiBbIm0iLCJNIl06CgkJCQkJCXdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwKSBhcyBjb2VnOgoJCQkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCQkJcHJpbnQoZiJ7UH1b4oCiXSBFeGFtcGxlIHBhc3N3b3JkIDoge0J9c2F5YW5nLGFuamluZyxrb250b2wiKQoJCQkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCQkJYXN1ID0gaW5wdXQoZiJ7UH1b4oCiXSBNYWtlIHB3IDoge0J9Iikuc3BsaXQoIiwiKQoJCQkJCQkJaWYgbGVuKGFzdSkgPT0iIjoKCQkJCQkJCQlwcmludChmIntCfSB8ICIpCgkJCQkJCQkJcHJpbnQoZiJ7UH1b4oCiXXtNfSBTYW5kaSB0aWRhayBib2xlaCBrb3NvbmciKTtleGl0KCkKCQkJCQkJCXN0YXJ0ZWQoKQoJCQkJCQkJZm9yIHVzZXIgaW4gaWQ6CgkJCQkJCQkJdWlkLCBuYW1lID0gdXNlci5zcGxpdCgiPD0+IikKCQkJCQkJCQljb2VnLnN1Ym1pdChhcGksIHVpZCwgYXN1KQoJCQkJCQlleGl0KCkKCQkJCQllbGlmIHRlciBpbiBbImQiLCJEIl06CgkJCQkJCXdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwKSBhcyBjb2VnOgoJCQkJCQkJc3RhcnRlZCgpCgkJCQkJCQlmb3IgdXNlciBpbiBpZDoKCQkJCQkJCQl1aWQsIG5hbWUgPSB1c2VyLnNwbGl0KCI8PT4iKQoJCQkJCQkJCWZyaXN0PW5hbWUuc3BsaXQoIiAiKQoJCQkJCQkJCWlmIGxlbihmcmlzdCk+PTY6CgkJCQkJCQkJCWZpaSA9IFsgbmFtZSwgZnJpc3RbMF0sIGZyaXN0WzBdKyIxMjMiLCBmcmlzdFswXSsiMTIzNDUiLCBmcmlzdFswXSsiMTIzNDU2IiBdCgkJCQkJCQkJZWxpZiBsZW4oZnJpc3QpPD0yOgoJCQkJCQkJCQlmaWkgPSBbIG5hbWUsIGZyaXN0WzBdLCBmcmlzdFswXSsiMTIzIiwgZnJpc3RbMF0rIjEyMzQ1IiwgZnJpc3RbMF0rIjEyMzQ1NiIgXQoJCQkJCQkJCWVsaWYgbGVuKGZyaXN0KTw9MzoKCQkJCQkJCQkJZmlpID0gWyBuYW1lLCBmcmlzdFswXSwgZnJpc3RbMF0rIjEyMyIsIGZyaXN0WzBdKyIxMjM0NSIsIGZyaXN0WzBdKyIxMjM0NTYiIF0KCQkJCQkJCQllbHNlOgoJCQkJCQkJCQlmaWkgPSBbICJiaXNzbWlsYWgiLCAiYW5qaW5nIiwgImluZG9uZXNpYSIsICJzYXlhbmdrYW11IiBdCgkJCQkJCQkJY29lZy5zdWJtaXQoYXBpLCB1aWQsIGZpaSkKCQkJCQkJZXhpdCgpCgkJCQllbHNlOnByaW50KGYie1B9W+KAol17TX0gRXJvciIpO2V4aXQoKQoJCQlleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KGYie1B9W+KAol17TX0gRXJvciIpO2V4aXQoKQoKCQllbHNlOgoJCQlwcmludChmIntCfSB8ICIpCgkJCXByaW50KGYie1B9W+KAol0gQ1JBQ0sgVVNFIFBXIE1BTlVBTC9ERUZBVUxUIC0+IHtCfShNL0QpIikKCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQl0ZXIgPWlucHV0KGYie1B9W+KAol0gQ2hvb3NlIDoge0J9IikKCQkJaWYgdGVyIGluIFsibSIsIk0iXToKCQkJCXdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwKSBhcyBjb2VnOgoJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQlwcmludChmIntQfVvigKJdIEV4YW1wbGUgcGFzc3dvcmQgOiB7Qn1zYXlhbmcsYW5qaW5nLGtvbnRvbCIpCgkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCWFzdSA9IGlucHV0KGYie1B9W+KAol0gTWFrZSBwdyA6IHtCfSIpLnNwbGl0KCIsIikKCQkJCQlpZiBsZW4oYXN1KSA9PSIiOgoJCQkJCQlwcmludChmIntCfSB8ICIpCgkJCQkJCXByaW50KGYie1B9W+KAol17TX0gU2FuZGkgdGlkYWsgYm9sZWgga29zb25nIikKCQkJCQlzdGFydGVkKCkKCQkJCQlmb3IgdXNlciBpbiBpZDoKCQkJCQkJdWlkLCBuYW1lID0gdXNlci5zcGxpdCgiPD0+IikKCQkJCQkJY29lZy5zdWJtaXQoYXBpLCB1aWQsIGFzdSkKCQkJCWV4aXQoKQoJCQllbGlmIHRlciBpbiBbImQiLCJEIl06CgkJCQl3aXRoIFRocmVhZFBvb2xFeGVjdXRvcihtYXhfd29ya2Vycz0zMCkgYXMgY29lZzoKCQkJCQlzdGFydGVkKCkKCQkJCQlmb3IgdXNlciBpbiBpZDoKCQkJCQkJdWlkLCBuYW1lID0gdXNlci5zcGxpdCgiPD0+IikKCQkJCQkJZnJpc3Q9bmFtZS5zcGxpdCgiICIpCgkJCQkJCWlmIGxlbihmcmlzdCk+PTY6CgkJCQkJCQlmaWkgPSBbIG5hbWUsIGZyaXN0WzBdLCBmcmlzdFswXSsiMTIzIiwgZnJpc3RbMF0rIjEyMzQ1IiwgZnJpc3RbMF0rIjEyMzQ1NiIgXQoJCQkJCQllbGlmIGxlbihmcmlzdCk8PTI6CgkJCQkJCQlmaWkgPSBbIG5hbWUsIGZyaXN0WzBdLCBmcmlzdFswXSsiMTIzIiwgZnJpc3RbMF0rIjEyMzQ1IiwgZnJpc3RbMF0rIjEyMzQ1NiIgXQoJCQkJCQllbGlmIGxlbihmcmlzdCk8PTM6CgkJCQkJCQlmaWkgPSBbIG5hbWUsIGZyaXN0WzBdLCBmcmlzdFswXSsiMTIzIiwgZnJpc3RbMF0rIjEyMzQ1IiwgZnJpc3RbMF0rIjEyMzQ1NiIgXQoJCQkJCQllbHNlOgoJCQkJCQkJZmlpID0gWyAiYmlzc21pbGFoIiwgImFuamluZyIsICJpbmRvbmVzaWEiLCAic2F5YW5na2FtdSIgXQoKCQkJCQkJY29lZy5zdWJtaXQoYXBpaWlpLCB1aWQsIGZpaSkKCQkJCWV4aXQoKQoKCWVsaWYgZmlpc2F5YW5nd2lkaXlhIGluIFsiMyIsIjAzIl06CgkJcHJpbnQoZiJ7Qn0gfCAiKQoJCXByaW50KGYie1B9W+KAol0gU0hPVyBDUCBPUFRJT04gLT4ge0J9KFkvdCkiKQoJCWphbGFuKGYie1B9W+KAol17TX0gLT4gKk1ha2UgR29vZCwgdXNlIG9mIHlvdXIgYnJhaW4qIBoiKQoJCXByaW50KGYie0J9IHwgIikKCQlfY2hlY2tvcHRpb25zXz1pbnB1dChmIntQfVvigKJdIENob29zZSA6IHtCfSIpCgkJaWYgX2NoZWNrb3B0aW9uc18gaW4gWyJ5IiwiWSJdOgoJCQl0cnk6CgkJCQlfa2V5ID0gIkFuamluayIKCQkJCWtleSA9ICJBbmppbmsiCgkJCQlpZiBfa2V5IGluIGtleToKCQkJCQlwcmludChmIntCfSB8ICIpCgkJCQkJcHJpbnQoZiJ7UH1b4oCiXSBDUkFDSyBVU0UgUFcgTUFOVUFML0RFRkFVTFQgLT4ge0J9KE0vRCkiKQoJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQl0ZXIgPWlucHV0KGYie1B9W+KAol0gQ2hvb3NlIDoge0J9IikKCQkJCQlpZiB0ZXIgaW4gWyJtIiwiTSJdOgoJCQkJCQl3aXRoIFRocmVhZFBvb2xFeGVjdXRvcihtYXhfd29ya2Vycz0zMCkgYXMgY29lZzoKCQkJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQkJCXByaW50KGYie1B9W+KAol0gRXhhbXBsZSBwYXNzd29yZCA6IHtCfXNheWFuZyxhbmppbmcsa29udG9sIikKCQkJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQkJCWFzdSA9IGlucHV0KGYie1B9W+KAol0gTWFrZSBwdyA6IHtCfSAiKS5zcGxpdCgiLCIpCgkJCQkJCQlpZiBsZW4oYXN1KSA9PSIiOgoJCQkJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQkJCQlwcmludChmIntQfVvigKJde019IFNhbmRpIHRpZGFrIGJvbGVoIGtvc29uZyBhbmppbmsiKTtleGl0KCkKCQkJCQkJCXN0YXJ0ZWQoKQoJCQkJCQkJZm9yIHVzZXIgaW4gaWQ6CgkJCQkJCQkJdWlkLCBuYW1lID0gdXNlci5zcGxpdCgiPD0+IikKCQkJCQkJCQljb2VnLnN1Ym1pdChtYmFzaWMsIHVpZCwgYXN1KQoJCQkJCQlleGl0KCkKCQkJCQllbGlmIHRlciBpbiBbImQiLCJEIl06CgkJCQkJCXdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwKSBhcyBjb2VnOgoJCQkJCQkJc3RhcnRlZCgpCgkJCQkJCQlmb3IgdXNlciBpbiBpZDoKCQkJCQkJCQl1aWQsIG5hbWUgPSB1c2VyLnNwbGl0KCI8PT4iKQoJCQkJCQkJCWZyaXN0PW5hbWUuc3BsaXQoIiAiKQoJCQkJCQkJCWlmIGxlbihmcmlzdCk+PTY6CgkJCQkJCQkJCWZpaSA9IFsgbmFtZSwgZnJpc3RbMF0sIGZyaXN0WzBdKyIxMjMiLCBmcmlzdFswXSsiMTIzNDUiLCBmcmlzdFswXSsiMTIzNDU2IiBdCgkJCQkJCQkJZWxpZiBsZW4oZnJpc3QpPD0yOgoJCQkJCQkJCQlmaWkgPSBbIG5hbWUsIGZyaXN0WzBdLCBmcmlzdFswXSsiMTIzIiwgZnJpc3RbMF0rIjEyMzQ1IiwgZnJpc3RbMF0rIjEyMzQ1NiIgXQoJCQkJCQkJCWVsaWYgbGVuKGZyaXN0KTw9MzoKCQkJCQkJCQkJZmlpID0gWyBuYW1lLCBmcmlzdFswXSwgZnJpc3RbMF0rIjEyMyIsIGZyaXN0WzBdKyIxMjM0NSIsIGZyaXN0WzBdKyIxMjM0NTYiIF0KCQkJCQkJCQllbHNlOgoJCQkJCQkJCQlmaWkgPSBbICJiaXNzbWlsYWgiLCAiYW5qaW5nIiwgImluZG9uZXNpYSIsICJzYXlhbmdrYW11IiBdCgkJCQkJCQkJY29lZy5zdWJtaXQobW9iaWwsIHVpZCwgZmlpKQoJCQkJCQlleGl0KCkKCQkJCWVsc2U6cHJpbnQoZiJ7a2V5fSIpO2V4aXQoKQoJCQlleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KGYie19rZXl9Iik7ZXhpdCgpCgoJCWVsc2U6CgkJCXByaW50KGYie0J9IHwgIikKCQkJcHJpbnQoZiJ7UH1b4oCiXSBDUkFDSyBVU0UgUFcgTUFOVUFML0RFRkFVTFQgLT4ge0J9KE0vRCkiKQoJCQlwcmludChmIntCfSB8ICIpCgkJCXRlciA9aW5wdXQoZiJ7UH1b4oCiXSBDaG9vc2UgOiB7Qn0iKQoJCQlpZiB0ZXIgaW4gWyJtIiwiTSJdOgoJCQkJd2l0aCBUaHJlYWRQb29sRXhlY3V0b3IobWF4X3dvcmtlcnM9MzApIGFzIGNvZWc6CgkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCXByaW50KGYie1B9W+KAol0gRXhhbXBsZSBwYXNzd29yZCB7Qn1Bbmppbmssa29udG9sLHNheWFuZyIpCgkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCWFzdSA9IGlucHV0KGYie1B9W+KAol0gTWFrZSBwdyA6IHtCfSIpLnNwbGl0KCIsIikKCQkJCQlpZiBsZW4oYXN1KSA9PSIiOgoJCQkJCQlwcmludChmIntCfSB8ICIpCgkJCQkJCXByaW50KGYie1B9W+KAol17TX0gU2FuZGkgdGlkYWsgYm9sZWgga29zb25nIik7ZXhpdCgpCgkJCQkJc3RhcnRlZCgpCgkJCQkJZm9yIHVzZXIgaW4gaWQ6CgkJCQkJCXVpZCwgbmFtZSA9IHVzZXIuc3BsaXQoIjw9PiIpCgkJCQkJCWNvZWcuc3VibWl0KG1iYXNpY2MsIHVpZCwgYXN1KQoJCQkJZXhpdCgpCgkJCWVsaWYgdGVyIGluIFsiZCIsIkQiXToKCQkJCXdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwKSBhcyBjb2VnOgoJCQkJCXN0YXJ0ZWQoKQoJCQkJCWZvciB1c2VyIGluIGlkOgoJCQkJCQl1aWQsIG5hbWUgPSB1c2VyLnNwbGl0KCI8PT4iKQoJCQkJCQlmcmlzdD1uYW1lLnNwbGl0KCIgIikKCQkJCQkJaWYgbGVuKGZyaXN0KT49NjoKCQkJCQkJCWZpaSA9IFsgbmFtZSwgZnJpc3RbMF0sIGZyaXN0WzBdKyIxMjMiLCBmcmlzdFswXSsiMTIzNDUiLCBmcmlzdFswXSsiMTIzNDU2IiBdCgkJCQkJCWVsaWYgbGVuKGZyaXN0KTw9MjoKCQkJCQkJCWZpaSA9IFsgbmFtZSwgZnJpc3RbMF0sIGZyaXN0WzBdKyIxMjMiLCBmcmlzdFswXSsiMTIzNDUiLCBmcmlzdFswXSsiMTIzNDU2IiBdCgkJCQkJCWVsaWYgbGVuKGZyaXN0KTw9MzoKCQkJCQkJCWZpaSA9IFsgbmFtZSwgZnJpc3RbMF0sIGZyaXN0WzBdKyIxMjMiLCBmcmlzdFswXSsiMTIzNDUiLCBmcmlzdFswXSsiMTIzNDU2IiBdCgkJCQkJCWVsc2U6CgkJCQkJCQlmaWkgPSBbICJiaXNzbWlsYWgiLCAiYW5qaW5nIiwgImluZG9uZXNpYSIsICJzYXlhbmdrYW11IiBdCgkJCQkJCWNvZWcuc3VibWl0KG1vYmlsbCwgdWlkLCBmaWkpCgkJCQlleGl0KCkKCQkJCQoJZWxpZiBmaWlzYXlhbmd3aWRpeWEgaW4gWyIyIiwiMDIiXToKCQlwcmludChmIntCfSB8ICIpCgkJcHJpbnQoZiJ7UH1b4oCiXSBTSE9XIENQIE9QVElPTiAtPiB7Qn0oWS90KSIpCgkJamFsYW4oZiJ7UH1b4oCiXXtNfSAtPiAqTWFrZSBHb29kLCB1c2Ugb2YgeW91ciBicmFpbiogGiIpCgkJcHJpbnQoZiJ7Qn0gfCAiKQoJCV9jaGVja29wdGlvbnNfPWlucHV0KGYie1B9W+KAol0gQ2hvb3NlIDoge0J9IikKCQlpZiBfY2hlY2tvcHRpb25zXyBpbiBbInkiLCJZIl06CgkJCXRyeToKCQkJCV9rZXkgPSAiQW5qaW5rIgoJCQkJa2V5ID0gIkFuamluayIKCQkJCWlmIF9rZXkgaW4ga2V5OgoJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQlwcmludChmIntQfVvigKJdIENSQUNLIFVTRSBQVyBNQU5VQUwvREVGQVVMVCAtPiB7Qn0oTS9EKSIpCgkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCXRlciA9aW5wdXQoZiJ7UH1b4oCiXSBDaG9vc2UgOiB7Qn0iKQoJCQkJCWlmIHRlciBpbiBbIm0iLCJNIl06CgkJCQkJCXdpdGggVGhyZWFkUG9vbEV4ZWN1dG9yKG1heF93b3JrZXJzPTMwKSBhcyBjb2VnOgoJCQkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCQkJcHJpbnQoZiJ7UH1b4oCiXSBFeGFtcGxlIHBhc3N3b3JkIDoge0J9c2F5YW5nLGFuamluZyxrb250b2wiKQoJCQkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCQkJYXN1ID0gaW5wdXQoZiJ7UH1b4oCiXSBNYWtlIHB3IDoge0J9ICIpLnNwbGl0KCIsIikKCQkJCQkJCWlmIGxlbihhc3UpID09IiI6CgkJCQkJCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQkJCQkJCXByaW50KGYie1B9W+KAol17TX0gU2FuZGkgdGlkYWsgYm9sZWgga29zb25nIGFuamluayIpO2V4aXQoKQoJCQkJCQkJc3RhcnRlZCgpCgkJCQkJCQlmb3IgdXNlciBpbiBpZDoKCQkJCQkJCQl1aWQsIG5hbWUgPSB1c2VyLnNwbGl0KCI8PT4iKQoJCQkJCQkJCWNvZWcuc3VibWl0KG1iYXNpYywgdWlkLCBhc3UpCgkJCQkJCWV4aXQoKQoJCQkJCWVsaWYgdGVyIGluIFsiZCIsIkQiXToKCQkJCQkJd2l0aCBUaHJlYWRQb29sRXhlY3V0b3IobWF4X3dvcmtlcnM9MzApIGFzIGNvZWc6CgkJCQkJCQlzdGFydGVkKCkKCQkJCQkJCWZvciB1c2VyIGluIGlkOgoJCQkJCQkJCXVpZCwgbmFtZSA9IHVzZXIuc3BsaXQoIjw9PiIpCgkJCQkJCQkJZnJpc3Q9bmFtZS5zcGxpdCgiICIpCgkJCQkJCQkJaWYgbGVuKGZyaXN0KT49NjoKCQkJCQkJCQkJZmlpID0gWyBuYW1lLCBmcmlzdFswXSwgZnJpc3RbMF0rIjEyMyIsIGZyaXN0WzBdKyIxMjM0NSIsIGZyaXN0WzBdKyIxMjM0NTYiIF0KCQkJCQkJCQllbGlmIGxlbihmcmlzdCk8PTI6CgkJCQkJCQkJCWZpaSA9IFsgbmFtZSwgZnJpc3RbMF0sIGZyaXN0WzBdKyIxMjMiLCBmcmlzdFswXSsiMTIzNDUiLCBmcmlzdFswXSsiMTIzNDU2IiBdCgkJCQkJCQkJZWxpZiBsZW4oZnJpc3QpPD0zOgoJCQkJCQkJCQlmaWkgPSBbIG5hbWUsIGZyaXN0WzBdLCBmcmlzdFswXSsiMTIzIiwgZnJpc3RbMF0rIjEyMzQ1IiwgZnJpc3RbMF0rIjEyMzQ1NiIgXQoJCQkJCQkJCWVsc2U6CgkJCQkJCQkJCWZpaSA9IFsgImJpc3NtaWxhaCIsICJhbmppbmciLCAiaW5kb25lc2lhIiwgInNheWFuZ2thbXUiIF0KCQkJCQkJCQljb2VnLnN1Ym1pdChtYmFzaWMsIHVpZCwgZmlpKQoJCQkJCQlleGl0KCkKCQkJCWVsc2U6cHJpbnQoZiJ7a2V5fSIpO2V4aXQoKQoJCQlleGNlcHQgKEtleUVycm9yLElPRXJyb3IpOnByaW50KGYie19rZXl9Iik7ZXhpdCgpCgoJCWVsc2U6CgkJCXByaW50KGYie0J9IHwgIikKCQkJcHJpbnQoZiJ7Qn0gfCAiKQoJCQlwcmludChmIntQfVvigKJdIENSQUNLIFVTRSBQVyBNQU5VQUwvREVGQVVMVCAtPiB7Qn0oTS9EKSIpCgkJCXByaW50KGYie0J9IHwgIikKCQkJdGVyID1pbnB1dChmIntQfVvigKJdIENob29zZSA6IHtCfSIpCgkJCWlmIHRlciBpbiBbIm0iLCJNIl06CgkJCQl3aXRoIFRocmVhZFBvb2xFeGVjdXRvcihtYXhfd29ya2Vycz0zMCkgYXMgY29lZzoKCQkJCQlwcmludChmIntCfSB8ICIpCgkJCQkJcHJpbnQoZiJ7UH1b4oCiXSBFeGFtcGxlIHBhc3N3b3JkIHtCfUFuamluayxrb250b2wsc2F5YW5nIikKCQkJCQlwcmludChmIntCfSB8ICIpCgkJCQkJYXN1ID0gaW5wdXQoZiJ7UH1b4oCiXSBNYWtlIHB3IDoge0J9Iikuc3BsaXQoIiwiKQoJCQkJCWlmIGxlbihhc3UpID09IiI6CgkJCQkJCXByaW50KGYie0J9IHwgIikKCQkJCQkJcHJpbnQoZiJ7UH1b4oCiXXtNfSBTYW5kaSB0aWRhayBib2xlaCBrb3NvbmciKTtleGl0KCkKCQkJCQlzdGFydGVkKCkKCQkJCQlmb3IgdXNlciBpbiBpZDoKCQkJCQkJdWlkLCBuYW1lID0gdXNlci5zcGxpdCgiPD0+IikKCQkJCQkJY29lZy5zdWJtaXQobWJhc2ljYywgdWlkLCBhc3UpCgkJCQlleGl0KCkKCQkJZWxpZiB0ZXIgaW4gWyJkIiwiRCJdOgoJCQkJd2l0aCBUaHJlYWRQb29sRXhlY3V0b3IobWF4X3dvcmtlcnM9MzApIGFzIGNvZWc6CgkJCQkJc3RhcnRlZCgpCgkJCQkJZm9yIHVzZXIgaW4gaWQ6CgkJCQkJCXVpZCwgbmFtZSA9IHVzZXIuc3BsaXQoIjw9PiIpCgkJCQkJCWZyaXN0PW5hbWUuc3BsaXQoIiAiKQoJCQkJCQlpZiBsZW4oZnJpc3QpPj02OgoJCQkJCQkJZmlpID0gWyBuYW1lLCBmcmlzdFswXSwgZnJpc3RbMF0rIjEyMyIsIGZyaXN0WzBdKyIxMjM0NSIsIGZyaXN0WzBdKyIxMjM0NTYiIF0KCQkJCQkJZWxpZiBsZW4oZnJpc3QpPD0yOgoJCQkJCQkJZmlpID0gWyBuYW1lLCBmcmlzdFswXSwgZnJpc3RbMF0rIjEyMyIsIGZyaXN0WzBdKyIxMjM0NSIsIGZyaXN0WzBdKyIxMjM0NTYiIF0KCQkJCQkJZWxpZiBsZW4oZnJpc3QpPD0zOgoJCQkJCQkJZmlpID0gWyBuYW1lLCBmcmlzdFswXSwgZnJpc3RbMF0rIjEyMyIsIGZyaXN0WzBdKyIxMjM0NSIsIGZyaXN0WzBdKyIxMjM0NTYiIF0KCQkJCQkJZWxzZToKCQkJCQkJCWZpaSA9IFsgImJpc3NtaWxhaCIsICJhbmppbmciLCAiaW5kb25lc2lhIiwgInNheWFuZ2thbXUiIF0KCQkJCQkJY29lZy5zdWJtaXQobWJhc2ljYywgdWlkLCBmaWkpCgkJCQlleGl0KCkKCQkJCQpkZWYga29uZSgpOgogICAgcHJpbnQoZiJ7Qn0gfCAiKQogICAgcHJpbnQoZiJ7UH1bMV0gIEItQVBJIC0+IHtCfUZhc3QiKQogICAgcHJpbnQoZiJ7UH1bMl0gTUJBU0lDIC0+IHtCfUxvdyIpCiAgICBwcmludChmIntQfVszXSBNT0JJTEUgLT4ge0J9VmVyeSBsb3ciKQoKZGVmIHN0YXJ0ZWQoKToKICAgIHByaW50KGYie0J9IHwgIikKICAgIHByaW50KGYie1B9W+KAol17Qn0gUkVTVUxUIHtJfU9LIHtCfVNBVkUgLT4ge0l9T0sve3RhbmdnYWx9IikKICAgIHByaW50KGYie1B9W+KAol17Qn0gUkVTVUxUIHtLfUNQIHtCfVNBVkUgLT4ge0t9Q1Ave3RhbmdnYWx9IikKICAgIHByaW50KGYie0J9IHwgIikKICAgIHByaW50KGYie1B9W+KAol0gSWYgWW91IE5vIFJlc3VsdCBBaXJwbGFuZSBNb2RlIDUgU2Vjb25kcyIpCiAgICBwcmludChmIntCfSB8IHtQfSIpCgpkZWYgYXBpKHVpZCwgZmlpKToKICAgIHRyeToKICAgICAgICB1YSA9IG9wZW4oInVhIiwgInIiKS5yZWFkKCkKICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIHVhID0gIm5va2lhYzMtMDAvNS4wICgwNy4yMCkgcHJvZmlsZS9taWRwLTIuMSBjb25maWd1cmF0aW9uL2NsZGMtMS4xIG1vemlsbGEvNS4wIGFwcGxld2Via2l0LzQyMCsgKGtodG1sLCBsaWtlIGdlY2tvKSBzYWZhcmkvNDIwKyIKICAgIGdsb2JhbCBvaywgY3AsIGxvb3AsIHRva2VuLCBjb29raWUKICAgIHN5cy5zdGRvdXQud3JpdGUoZiJccntQfVvigKJdIC0+e0J9IHtsb29wfS97bGVuKGlkKX0ge0l9W09LXSA6IHtCfXtsZW4ob2spfSB8e0t9IFtDUF0gOiB7Qn17bGVuKGNwKX0iKTtzeXMuc3Rkb3V0LmZsdXNoKCkKICAgIGZvciBwdyBpbiBmaWk6CiAgICAgICAgcHcgPSBwdy5sb3dlcigpCiAgICAgICAgaGVhZGVyc18gPSB7IngtZmItY29ubmVjdGlvbi1iYW5kd2lkdGgiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAwMDAuMCwgMzAwMDAwMDAuMCkpLCAieC1mYi1zaW0taG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCAieC1mYi1uZXQtaG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCAieC1mYi1jb25uZWN0aW9uLXF1YWxpdHkiOiAiRVhDRUxMRU5UIiwgIngtZmItY29ubmVjdGlvbi10eXBlIjogImNlbGwuQ1RSYWRpb0FjY2Vzc1RlY2hub2xvZ3lIU0RQQSIsICJ1c2VyLWFnZW50IjogdWEsICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgIngtZmItaHR0cC1lbmdpbmUiOiAiTGlnZXIifQogICAgICAgIHNlcyA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgICAgIHNlbmQgPSBzZXMuZ2V0KCJodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbj9mb3JtYXQ9anNvbiZlbWFpbD0iK3N0cih1aWQpKyImcGFzc3dvcmQ9IitzdHIocHcpKyImY3JlZGVudGlhbHNfdHlwZT1kZXZpY2VfYmFzZWRfbG9naW5fcGFzc3dvcmQmZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzPTEmZXJyb3JfZGV0YWlsX3R5cGU9YnV0dG9uX3dpdGhfZGlzYWJsZWQmc291cmNlPWRldmljZV9iYXNlZF9sb2dpbiZtZXRhX2luZl9mYm1ldGE9JTIwJmN1cnJlbnRseV9sb2dnZWRfaW5sb2xvbGlkPTAmbWV0aG9kPUdFVCZsb2NhbGU9ZW5fVVMmY2xpZW50X2NvdW50cnlfY29kZT1VUyZmYl9hcGlfY2FsbGVyX2NsYXNzPWNvbS5mYWNlYm9vay5mb3MuaGVhZGVyc3YyLmZiNGFvcmNhLkhlYWRlcnNWMkNvbmZpZ0ZldGNoUmVxdWVzdEhhbmRsZXImYWNjZXNzX3Rva2VuPTM1MDY4NTUzMTcyOHw2MmY4Y2U5Zjc0YjEyZjg0YzEyM2NjMjM0MzdhNGEzMiZmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWU9YXV0aGVudGljYXRlJmNwbD10cnVlIiwgaGVhZGVycz1oZWFkZXJzXykKICAgICAgICBpZiAic2Vzc2lvbl9rZXkiIGluIHNlbmQudGV4dCBhbmQgIkVBQUEiIGluIHNlbmQudGV4dDoKICAgICAgICAgICAgcHJpbnQoZiJccntCfSB8LT4ge0l9e3VpZH0g4pyTIHtwd30iKQogICAgICAgICAgICBvay5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCiAgICAgICAgICAgIG9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxpZiAid3d3LmZhY2Vib29rLmNvbSIgaW4gc2VuZC5qc29uKClbImVycm9yX21zZyJdOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0b2tlbiAgPSBvcGVuKCdsb2dpbi90b2tlbi5qc29uJywncicpLnJlYWQoKQogICAgICAgICAgICAgICAgY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KICAgICAgICAgICAgICAgIHR0bCA9IHNlcy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyIlKHVpZCwgdG9rZW4pLGNvb2tpZXM9Y29va2llKS5qc29uKClbImJpcnRoZGF5Il0KICAgICAgICAgICAgICAgIG1vbnRoLCBkYXksIHllYXIgPSB0dGwuc3BsaXQoIi8iKQogICAgICAgICAgICAgICAgbW9udGggPSBfYnVsYW5fW21vbnRoXQogICAgICAgICAgICAgICAgcHJpbnQoZiJccntCfSB8LT4ge0t9e3VpZH0gw5cge3B3feKAontkYXl9IHttb250aH0ge3llYXJ9IikKICAgICAgICAgICAgICAgIGNwLmFwcGVuZCgiJXN8JXMiJSh1aWQsIHB3KSkKICAgICAgICAgICAgICAgIG9wZW4oIkNQLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc3wlcyAlcyAlc1xuIiUodWlkLCBwdywgZGF5LCBtb250aCwgeWVhcikpCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICAgICAgICAgIGRheSA9ICgiICIpCiAgICAgICAgICAgICAgICBtb250aCA9ICgiICIpCiAgICAgICAgICAgICAgICB5ZWFyID0gKCIgIikKICAgICAgICAgICAgZXhjZXB0OnBhc3MKICAgICAgICAgICAgY2VrX2xvZyh1aWQscHcsdWEpCiAgICAgICAgICAgIHByaW50KGYiXHJ7Qn0gfC0+IHtLfXt1aWR9IMOXIHtwd30iKQogICAgICAgICAgICBjcC5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCiAgICAgICAgICAgIG9wZW4oIkNQLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29udGludWUKCiAgICBsb29wICs9IDEKCmRlZiBhcGlpaWkodWlkLCBmaWkpOgogICAgdHJ5OgogICAgICAgIHVhID0gb3BlbigidWEiLCAiciIpLnJlYWQoKQogICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgdWEgPSAibm9raWFjMy0wMC81LjAgKDA3LjIwKSBwcm9maWxlL21pZHAtMi4xIGNvbmZpZ3VyYXRpb24vY2xkYy0xLjEgbW96aWxsYS81LjAgYXBwbGV3ZWJraXQvNDIwKyAoa2h0bWwsIGxpa2UgZ2Vja28pIHNhZmFyaS80MjArIgogICAgZ2xvYmFsIG9rLCBjcCwgbG9vcCwgdG9rZW4sIGNvb2tpZQoKICAgIHN5cy5zdGRvdXQud3JpdGUoZiJccntQfVvigKJdIC0+e0J9IHtsb29wfS97bGVuKGlkKX0ge0l9W09LXSA6IHtCfXtsZW4ob2spfSB8e0t9IFtDUF0gOiB7Qn17bGVuKGNwKX0iKTtzeXMuc3Rkb3V0LmZsdXNoKCkKICAgIGZvciBwdyBpbiBmaWk6CiAgICAgICAgcHcgPSBwdy5sb3dlcigpCiAgICAgICAgaGVhZGVyc18gPSB7IngtZmItY29ubmVjdGlvbi1iYW5kd2lkdGgiOiBzdHIocmFuZG9tLnJhbmRpbnQoMjAwMDAwMDAuMCwgMzAwMDAwMDAuMCkpLCAieC1mYi1zaW0taG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCAieC1mYi1uZXQtaG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCAieC1mYi1jb25uZWN0aW9uLXF1YWxpdHkiOiAiRVhDRUxMRU5UIiwgIngtZmItY29ubmVjdGlvbi10eXBlIjogImNlbGwuQ1RSYWRpb0FjY2Vzc1RlY2hub2xvZ3lIU0RQQSIsICJ1c2VyLWFnZW50IjogdWEsICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgIngtZmItaHR0cC1lbmdpbmUiOiAiTGlnZXIifQogICAgICAgIHNlcyA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgICAgIHNlbmQgPSBzZXMuZ2V0KCJodHRwczovL2ItYXBpLmZhY2Vib29rLmNvbS9tZXRob2QvYXV0aC5sb2dpbj9mb3JtYXQ9anNvbiZlbWFpbD0iK3N0cih1aWQpKyImcGFzc3dvcmQ9IitzdHIocHcpKyImY3JlZGVudGlhbHNfdHlwZT1kZXZpY2VfYmFzZWRfbG9naW5fcGFzc3dvcmQmZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzPTEmZXJyb3JfZGV0YWlsX3R5cGU9YnV0dG9uX3dpdGhfZGlzYWJsZWQmc291cmNlPWRldmljZV9iYXNlZF9sb2dpbiZtZXRhX2luZl9mYm1ldGE9JTIwJmN1cnJlbnRseV9sb2dnZWRfaW5sb2xvbGlkPTAmbWV0aG9kPUdFVCZsb2NhbGU9ZW5fVVMmY2xpZW50X2NvdW50cnlfY29kZT1VUyZmYl9hcGlfY2FsbGVyX2NsYXNzPWNvbS5mYWNlYm9vay5mb3MuaGVhZGVyc3YyLmZiNGFvcmNhLkhlYWRlcnNWMkNvbmZpZ0ZldGNoUmVxdWVzdEhhbmRsZXImYWNjZXNzX3Rva2VuPTM1MDY4NTUzMTcyOHw2MmY4Y2U5Zjc0YjEyZjg0YzEyM2NjMjM0MzdhNGEzMiZmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWU9YXV0aGVudGljYXRlJmNwbD10cnVlIiwgaGVhZGVycz1oZWFkZXJzXykKICAgICAgICBpZiAic2Vzc2lvbl9rZXkiIGluIHNlbmQudGV4dCBhbmQgIkVBQUEiIGluIHNlbmQudGV4dDoKICAgICAgICAgICAgcHJpbnQoZiJccntCfSB8LT4ge0l9e3VpZH0g4pyTIHtwd30iKQogICAgICAgICAgICBvay5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCiAgICAgICAgICAgIG9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxpZiAid3d3LmZhY2Vib29rLmNvbSIgaW4gc2VuZC5qc29uKClbImVycm9yX21zZyJdOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICB0b2tlbiAgPSBvcGVuKCdsb2dpbi90b2tlbi5qc29uJywncicpLnJlYWQoKQogICAgICAgICAgICAgICAgY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KICAgICAgICAgICAgICAgIHR0bCA9IHNlcy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyIlKHVpZCwgdG9rZW4pLGNvb2tpZXM9Y29va2llKS5qc29uKClbImJpcnRoZGF5Il0KICAgICAgICAgICAgICAgIG1vbnRoLCBkYXksIHllYXIgPSB0dGwuc3BsaXQoIi8iKQogICAgICAgICAgICAgICAgbW9udGggPSBfYnVsYW5fW21vbnRoXQogICAgICAgICAgICAgICAgcHJpbnQoZiJccntCfSB8LT4ge0t9e3VpZH0gw5cge3B3feKAontkYXl9IHttb250fSB7eWVhcn0iKQogICAgICAgICAgICAgICAgY3AuYXBwZW5kKCIlc3wlcyIlKHVpZCwgcHcpKQogICAgICAgICAgICAgICAgb3BlbigiQ1AvJXMuanNvbiUiKHRhbmdnYWwpLCJhIikud3JpdGUoIiVzfCVzfCVzICVzICVzXG4iJSh1aWQsIHB3LCBkYXksIG1vbnRoLCB5ZWFyKSkKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgogICAgICAgICAgICAgICAgZGF5ID0gKCIgIikKICAgICAgICAgICAgICAgIG1vbnRoID0gKCIgIikKICAgICAgICAgICAgICAgIHllYXIgPSAoIiAiKQogICAgICAgICAgICBleGNlcHQ6cGFzcwogICAgICAgICAgICBwcmludChmIlxye0J9IHwtPiB7S317dWlkfSDDlyB7cHd9IikKICAgICAgICAgICAgY3AuYXBwZW5kKCIlc3wlcyIlKHVpZCwgcHcpKQogICAgICAgICAgICBvcGVuKCJDUC8lcy5qc29uIiUodGFuZ2dhbCksImEiKS53cml0ZSgiJXN8JXNcbiIlKHVpZCwgcHcpKQogICAgICAgICAgICBicmVhawogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgbG9vcCArPSAxCgpkZWYgbWJhc2ljKHVpZCwgZmlpKToKCXRyeToKCQl1YSA9IG9wZW4oInVhIiwgInIiKS5yZWFkKCkKCWV4Y2VwdCBJT0Vycm9yOgoJCXVhID0gIm5va2lhYzMtMDAvNS4wICgwNy4yMCkgcHJvZmlsZS9taWRwLTIuMSBjb25maWd1cmF0aW9uL2NsZGMtMS4xIG1vemlsbGEvNS4wIGFwcGxld2Via2l0LzQyMCsgKGtodG1sLCBsaWtlIGdlY2tvKSBzYWZhcmkvNDIwKyIKCWdsb2JhbCBvaywgY3AsIGxvb3AsIHRva2VuLCBjb29raWUKCXN5cy5zdGRvdXQud3JpdGUoZiJccntQfVvigKJdIC0+IHtCfXtsb29wfS97bGVuKGlkKX0ge0l9W09LXSA6IHtCfXtsZW4ob2spfSB8e0t9IFtDUF0gOiB7Qn17bGVuKGNwKX0iKTtzeXMuc3Rkb3V0LmZsdXNoKCkKCWZvciBwdyBpbiBmaWk6CgkJZmlpX2d0ZyA9IHt9CgkJcHcgPSBwdy5sb3dlcigpCgkJc2VzID0gcmVxdWVzdHMuU2Vzc2lvbigpCgkJc2VzLmhlYWRlcnMudXBkYXRlKHsib3JpZ2luIjogImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSIsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciLCAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCAidXNlci1hZ2VudCI6IHVhLCAiSG9zdCI6ICJtYmFzaWMuZmFjZWJvb2suY29tIiwgInJlZmVyZXIiOiAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCIsICJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsICJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjogIjEiLCAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCJ9KQoJCXAgPSBzZXMuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZyZWZpZD04IikudGV4dAoJCWIgPSBwYXJzZXIocCwiaHRtbC5wYXJzZXIiKQoJCWJsID0gWyJsc2QiLCJqYXpvZXN0IiwibV90cyIsImxpIiwidHJ5X251bWJlciIsInVucmVjb2duaXplZF90cmllcyIsImxvZ2luIl0KCQlmb3IgaSBpbiBiKCJpbnB1dCIpOgoJCQl0cnk6CgkJCQlpZiBpLmdldCgibmFtZSIpIGluIGJsOmZpaV9ndGcudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkKCQkJCWVsc2U6Y29udGludWUKCQkJZXhjZXB0OnBhc3MKCQlmaWlfZ3RnLnVwZGF0ZSh7ImVtYWlsIjogdWlkLCJwYXNzIjogcHcsInByZWZpbGxfY29udGFjdF9wb2ludCI6ICIiLCJwcmVmaWxsX3NvdXJjZSI6ICIiLCJwcmVmaWxsX3R5cGUiOiAiIiwiZmlyc3RfcHJlZmlsbF9zb3VyY2UiOiAiIiwiZmlyc3RfcHJlZmlsbF90eXBlIjogIiIsImhhZF9jcF9wcmVmaWxsZWQiOiAiZmFsc2UiLCJoYWRfcGFzc3dvcmRfcHJlZmlsbGVkIjogImZhbHNlIiwiaXNfc21hcnRfbG9jayI6ICJmYWxzZSIsIl9mYl9ub3NjcmlwdCI6ICJ0cnVlIn0pCgkJZGVrdSA9IHNlcy5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL3JlZ3VsYXIvbG9naW4vP3JlZnNyYz1odHRwcyUzQSUyRiUyRm1iYXNpYy5mYWNlYm9vay5jb20lMkYmbHd2PTEwMCZyZWZpZD04IixkYXRhPWZpaV9ndGcpCgkJaWYgImNfdXNlciIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJCWt1a2kgPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBzZXMuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkucmVwbGFjZSgibm9zY3JpcHQ9MTsiLCAiIikKCQkJcHJpbnQoZiJccntCfSB8LT4ge0l9e3VpZH0g4pyTIHtwd30iKQoJCQlvay5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCgkJCW9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCgkJCWJyZWFrCgkJZWxpZiAiY2hlY2twb2ludCIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJCXRyeToKCQkJCXRva2VuICA9IG9wZW4oJ2xvZ2luL3Rva2VuLmpzb24nLCdyJykucmVhZCgpCgkJCQljb29raWUgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQoJCQkJd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgc2VzOgoJCQkJCXR0bCA9IHNlcy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyIlKHVpZCwgdG9rZW4pLGNvb2tpZXM9Y29va2llKS5qc29uKClbImJpcnRoZGF5Il0KCQkJCQltb250aCwgZGF5LCB5ZWFyID0gdHRsLnNwbGl0KCIvIikKCQkJCQltb250aCA9IGJ1bGFuX3R0bFttb250aF0KCQkJCQlwcmludChmIlxye0J9IHwtPiB7S317dWlkfSDDlyB7cHd94oCie2RheX0ge21vbnRofSB7eWVhcn0iKQoJCQkJCWNwLmFwcGVuZCgiJXN8JXMiJSh1aWQsIHB3KSkKCQkJCQlvcGVuKCJDUC8lcy5qc29uIiUodGFuZ2dhbCksImEiKS53cml0ZSgiJXN8JXN8JXMgJXMgJXNcbiIlKHVpZCwgcHcsIGRheSwgbW9udGgsIHllYXIpKQoJCQkJCWJyZWFrCgkJCWV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgoJCQkJZGF5ID0gKCIgIikKCQkJCW1vbnRoID0gKCIgIikKCQkJCXllYXIgPSAoIiAiKQoJCQlleGNlcHQ6cGFzcwoJCQljZWtfbG9nKHVpZCxwdyx1YSkKCQkJcHJpbnQoZiJccntCfSB8LT4ge0t9e3VpZH0g4pyTIHtwd30iKQoJCQljcC5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCgkJCW9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCgkJCWJyZWFrCgkJZWxzZToKCQkJY29udGludWUKCglsb29wICs9IDEKCmRlZiBtYmFzaWNjKHVpZCwgZmlpKToKCXRyeToKCQl1YSA9IG9wZW4oInVhIiwgInIiKS5yZWFkKCkKCWV4Y2VwdCBJT0Vycm9yOgoJCXVhID0gIm5va2lhYzMtMDAvNS4wICgwNy4yMCkgcHJvZmlsZS9taWRwLTIuMSBjb25maWd1cmF0aW9uL2NsZGMtMS4xIG1vemlsbGEvNS4wIGFwcGxld2Via2l0LzQyMCsgKGtodG1sLCBsaWtlIGdlY2tvKSBzYWZhcmkvNDIwKyIKCWdsb2JhbCBvaywgY3AsIGxvb3AsIHRva2VuLCBjb29raWUKCXN5cy5zdGRvdXQud3JpdGUoZiJccntQfVvigKJdIC0+e0J9IHtsb29wfS97bGVuKGlkKX0ge0l9W09LXSA6IHtCfXtsZW4ob2spfSB8e0t9IFtDUF0gOiB7Qn17bGVuKGNwKX0iKTtzeXMuc3Rkb3V0LmZsdXNoKCkKCWZvciBwdyBpbiBmaWk6CgkJZmlpX2d0ZyA9IHt9CgkJcHcgPSBwdy5sb3dlcigpCgkJc2VzID0gcmVxdWVzdHMuU2Vzc2lvbigpCgkJc2VzLmhlYWRlcnMudXBkYXRlKHsib3JpZ2luIjogImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSIsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciLCAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCAidXNlci1hZ2VudCI6IHVhLCAiSG9zdCI6ICJtYmFzaWMuZmFjZWJvb2suY29tIiwgInJlZmVyZXIiOiAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCIsICJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsICJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjogIjEiLCAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCJ9KQoJCXAgPSBzZXMuZ2V0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZyZWZpZD04IikudGV4dAoJCWIgPSBwYXJzZXIocCwiaHRtbC5wYXJzZXIiKQoJCWJsID0gWyJsc2QiLCJqYXpvZXN0IiwibV90cyIsImxpIiwidHJ5X251bWJlciIsInVucmVjb2duaXplZF90cmllcyIsImxvZ2luIl0KCQlmb3IgaSBpbiBiKCJpbnB1dCIpOgoJCQl0cnk6CgkJCQlpZiBpLmdldCgibmFtZSIpIGluIGJsOmZpaV9ndGcudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkKCQkJCWVsc2U6Y29udGludWUKCQkJZXhjZXB0OnBhc3MKCQlmaWlfZ3RnLnVwZGF0ZSh7ImVtYWlsIjogdWlkLCJwYXNzIjogcHcsInByZWZpbGxfY29udGFjdF9wb2ludCI6ICIiLCJwcmVmaWxsX3NvdXJjZSI6ICIiLCJwcmVmaWxsX3R5cGUiOiAiIiwiZmlyc3RfcHJlZmlsbF9zb3VyY2UiOiAiIiwiZmlyc3RfcHJlZmlsbF90eXBlIjogIiIsImhhZF9jcF9wcmVmaWxsZWQiOiAiZmFsc2UiLCJoYWRfcGFzc3dvcmRfcHJlZmlsbGVkIjogImZhbHNlIiwiaXNfc21hcnRfbG9jayI6ICJmYWxzZSIsIl9mYl9ub3NjcmlwdCI6ICJ0cnVlIn0pCgkJZGVrdSA9IHNlcy5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL3JlZ3VsYXIvbG9naW4vP3JlZnNyYz1odHRwcyUzQSUyRiUyRm1iYXNpYy5mYWNlYm9vay5jb20lMkYmbHd2PTEwMCZyZWZpZD04IixkYXRhPWZpaV9ndGcpCgkJaWYgImNfdXNlciIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJCWt1a2kgPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBzZXMuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkucmVwbGFjZSgibm9zY3JpcHQ9MTsiLCAiIikKCQkJcHJpbnQoZiJccntCfSB8LT4ge0l9e3VpZH0g4pyTIHtwd30iKQoJCQlvay5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCgkJCW9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCgkJCWJyZWFrCgkJZWxpZiAiY2hlY2twb2ludCIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJCXRyeToKCQkJCXRva2VuICA9IG9wZW4oJ2xvZ2luL3Rva2VuLmpzb24nLCdyJykucmVhZCgpCgkJCQljb29raWUgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQoJCQkJd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgc2VzOgoJCQkJCXR0bCA9IHNlcy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyIlKHVpZCwgdG9rZW4pLGNvb2tpZXM9Y29va2llKS5qc29uKClbImJpcnRoZGF5Il0KCQkJCQltb250aCwgZGF5LCB5ZWFyID0gdHRsLnNwbGl0KCIvIikKCQkJCQltb250aCA9IGJ1bGFuX3R0bFttb250aF0KCQkJCQlwcmludChmIlxye0J9IHwtPiB7S317dWlkfSDDlyB7cHd94oCie2RheX0ge21vbnRofSB7eWVhcn0iKQoJCQkJCWNwLmFwcGVuZCgiJXN8JXMiJSh1aWQsIHB3KSkKCQkJCQlvcGVuKCJDUC8lcy5qc29uIiUodGFuZ2dhbCksImEiKS53cml0ZSgiJXN8JXN8JXMgJXMgJXNcbiIlKHVpZCwgcHcsIGRheSwgbW9udGgsIHllYXIpKQoJCQkJCWJyZWFrCgkJCWV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgoJCQkJZGF5ID0gKCIgIikKCQkJCW1vbnRoID0gKCIgIikKCQkJCXllYXIgPSAoIiAiKQoJCQlleGNlcHQ6cGFzcwoJCQlwcmludChmIlxye0J9IHwtPiB7S317dWlkfSDDlyB7cHd9IikKCQkJY3AuYXBwZW5kKCIlc3wlcyIlKHVpZCwgcHcpKQoJCQlvcGVuKCJDUC8lcy5qc29uIiUodGFuZ2dhbCksImEiKS53cml0ZSgiJXN8JXNcbiIlKHVpZCwgcHcpKQoJCQlicmVhawoJCWVsc2U6CgkJCWNvbnRpbnVlCgoJbG9vcCArPSAxCgkKZGVmIG1vYmlsKHVpZCwgZmlpKToKCXRyeToKCQl1YSA9IG9wZW4oInVhIiwgInIiKS5yZWFkKCkKCWV4Y2VwdCBJT0Vycm9yOgoJCXVhID0gIm5va2lhYzMtMDAvNS4wICgwNy4yMCkgcHJvZmlsZS9taWRwLTIuMSBjb25maWd1cmF0aW9uL2NsZGMtMS4xIG1vemlsbGEvNS4wIGFwcGxld2Via2l0LzQyMCsgKGtodG1sLCBsaWtlIGdlY2tvKSBzYWZhcmkvNDIwKyIKCWdsb2JhbCBvaywgY3AsIGxvb3AsIHRva2VuLCBjb29raWUKCXN5cy5zdGRvdXQud3JpdGUoZiJccntQfVvigKJdIC0+e0J9IHtsb29wfS97bGVuKGlkKX0ge0l9W09LXSA6IHtCfXtsZW4ob2spfSB8e0t9IFtDUF0gOiB7Qn17bGVuKGNwKX0iKTtzeXMuc3Rkb3V0LmZsdXNoKCkKCWZvciBwdyBpbiBmaWk6CgkJZmlpX2d0ZyA9IHt9CgkJcHcgPSBwdy5sb3dlcigpCgkJc2VzID0gcmVxdWVzdHMuU2Vzc2lvbigpCgkJc2VzLmhlYWRlcnMudXBkYXRlKHsib3JpZ2luIjogImh0dHBzOi8vbW9iaWxlLmZhY2Vib29rLmNvbSIsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjciLCAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLCAidXNlci1hZ2VudCI6IHVhLCAiSG9zdCI6ICJtYmFzaWMuZmFjZWJvb2suY29tIiwgInJlZmVyZXIiOiAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCIsICJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsICJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjogIjEiLCAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCJ9KQoJCXAgPSBzZXMuZ2V0KCJodHRwczovL21vYmlsZS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZyZWZpZD04IikudGV4dAoJCWIgPSBwYXJzZXIocCwiaHRtbC5wYXJzZXIiKQoJCWJsID0gWyJsc2QiLCJqYXpvZXN0IiwibV90cyIsImxpIiwidHJ5X251bWJlciIsInVucmVjb2duaXplZF90cmllcyIsImxvZ2luIl0KCQlmb3IgaSBpbiBiKCJpbnB1dCIpOgoJCQl0cnk6CgkJCQlpZiBpLmdldCgibmFtZSIpIGluIGJsOmZpaV9ndGcudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkKCQkJCWVsc2U6Y29udGludWUKCQkJZXhjZXB0OnBhc3MKCQlmaWlfZ3RnLnVwZGF0ZSh7ImVtYWlsIjogdWlkLCJwYXNzIjogcHcsInByZWZpbGxfY29udGFjdF9wb2ludCI6ICIiLCJwcmVmaWxsX3NvdXJjZSI6ICIiLCJwcmVmaWxsX3R5cGUiOiAiIiwiZmlyc3RfcHJlZmlsbF9zb3VyY2UiOiAiIiwiZmlyc3RfcHJlZmlsbF90eXBlIjogIiIsImhhZF9jcF9wcmVmaWxsZWQiOiAiZmFsc2UiLCJoYWRfcGFzc3dvcmRfcHJlZmlsbGVkIjogImZhbHNlIiwiaXNfc21hcnRfbG9jayI6ICJmYWxzZSIsIl9mYl9ub3NjcmlwdCI6ICJ0cnVlIn0pCgkJZGVrdSA9IHNlcy5wb3N0KCJodHRwczovL21vYmlsZS5mYWNlYm9vay5jb20vbG9naW4vZGV2aWNlLWJhc2VkL3JlZ3VsYXIvbG9naW4vP3JlZnNyYz1odHRwcyUzQSUyRiUyRm1iYXNpYy5mYWNlYm9vay5jb20lMkYmbHd2PTEwMCZyZWZpZD04IixkYXRhPWZpaV9ndGcpCgkJaWYgImNfdXNlciIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJCWt1a2kgPSAoIjsiKS5qb2luKFsgIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBzZXMuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCkgXSkucmVwbGFjZSgibm9zY3JpcHQ9MTsiLCAiIikKCQkJcHJpbnQoZiJccntCfSB8LT4ge0l9e3VpZH0g4pyTIHtwd30iKQoJCQlvay5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCgkJCW9wZW4oIk9LLyVzLmpzb24iJSh0YW5nZ2FsKSwiYSIpLndyaXRlKCIlc3wlc1xuIiUodWlkLCBwdykpCgkJCWJyZWFrCgkJZWxpZiAiY2hlY2twb2ludCIgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCk6CgkJCXRyeToKCQkJCXRva2VuICA9IG9wZW4oJ2xvZ2luL3Rva2VuLmpzb24nLCdyJykucmVhZCgpCgkJCQljb29raWUgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQoJCQkJd2l0aCByZXF1ZXN0cy5TZXNzaW9uKCkgYXMgc2VzOgoJCQkJCXR0bCA9IHNlcy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyIlKHVpZCwgdG9rZW4pLGNvb2tpZXM9Y29va2llKS5qc29uKClbImJpcnRoZGF5Il0KCQkJCQltb250aCwgZGF5LCB5ZWFyID0gdHRsLnNwbGl0KCIvIikKCQkJCQltb250aCA9IGJ1bGFuX3R0bFttb250aF0KCQkJCQlwcmludChmIlxye0J9IHwtPiB7S317dWlkfSDDlyB7cHd94oCie2RheX0ge21vbnRofSB7eWVhcn0iKQoJCQkJCWNwLmFwcGVuZCgiJXN8JXMiJSh1aWQsIHB3KSkKCQkJCQlvcGVuKCJDUC8lcy5qc29uIiUodGFuZ2dhbCksImEiKS53cml0ZSgiJXN8JXN8JXMgJXMgJXNcbiIlKHVpZCwgcHcsIGRheSwgbW9udGgsIHllYXIpKQoJCQkJCWJyZWFrCgkJCWV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgoJCQkJZGF5ID0gKCIgIikKCQkJCW1vbnRoID0gKCIgIikKCQkJCXllYXIgPSAoIiAiKQoJCQlleGNlcHQ6cGFzcwoJCQljZWtfbG9nKHVpZCxwdyx1YSkKCQkJcHJpbnQoZiJccntCfSB8LT4ge0t9e3VpZH0gw5cge3B3fSIpCgkJCWNwLmFwcGVuZCgiJXN8JXMiJSh1aWQsIHB3KSkKCQkJb3BlbigiQ1AvJXMuanNvbiIlKHRhbmdnYWwpLCJhIikud3JpdGUoIiVzfCVzXG4iJSh1aWQsIHB3KSkKCQkJYnJlYWsKCQllbHNlOgoJCQljb250aW51ZQoKCWxvb3AgKz0gMQoKZGVmIG1vYmlsbCh1aWQsIGZpaSk6Cgl0cnk6CgkJdWEgPSBvcGVuKCJ1YSIsICJyIikucmVhZCgpCglleGNlcHQgSU9FcnJvcjoKCQl1YSA9ICJub2tpYWMzLTAwLzUuMCAoMDcuMjApIHByb2ZpbGUvbWlkcC0yLjEgY29uZmlndXJhdGlvbi9jbGRjLTEuMSBtb3ppbGxhLzUuMCBhcHBsZXdlYmtpdC80MjArIChraHRtbCwgbGlrZSBnZWNrbykgc2FmYXJpLzQyMCsiCglnbG9iYWwgb2ssIGNwLCBsb29wLCB0b2tlbiwgY29va2llCglzeXMuc3Rkb3V0LndyaXRlKGYiXHJ7UH1b4oCiXSAtPntCfSB7bG9vcH0ve2xlbihpZCl9IHtJfVtPS10gOiB7Qn17bGVuKG9rKX0gfHtLfSBbQ1BdIDoge0J9e2xlbihjcCl9Iik7c3lzLnN0ZG91dC5mbHVzaCgpCglmb3IgcHcgaW4gZmlpOgoJCWZpaV9ndGcgPSB7fQoJCXB3ID0gcHcubG93ZXIoKQoJCXNlcyA9IHJlcXVlc3RzLlNlc3Npb24oKQoJCXNlcy5oZWFkZXJzLnVwZGF0ZSh7Im9yaWdpbiI6ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iLCAiYWNjZXB0LWxhbmd1YWdlIjogImlkLUlELGlkO3E9MC45LGVuLVVTO3E9MC44LGVuO3E9MC43IiwgImFjY2VwdC1lbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgImFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwgInVzZXItYWdlbnQiOiB1YSwgIkhvc3QiOiAibWJhc2ljLmZhY2Vib29rLmNvbSIsICJyZWZlcmVyIjogImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiLCAiY2FjaGUtY29udHJvbCI6ICJtYXgtYWdlPTAiLCAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6ICIxIiwgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQifSkKCQlwID0gc2VzLmdldCgiaHR0cHM6Ly9tb2JpbGUuZmFjZWJvb2suY29tL2xvZ2luLz9uZXh0JnJlZj1kYmwmcmVmaWQ9OCIpLnRleHQKCQliID0gcGFyc2VyKHAsImh0bWwucGFyc2VyIikKCQlibCA9IFsibHNkIiwiamF6b2VzdCIsIm1fdHMiLCJsaSIsInRyeV9udW1iZXIiLCJ1bnJlY29nbml6ZWRfdHJpZXMiLCJsb2dpbiJdCgkJZm9yIGkgaW4gYigiaW5wdXQiKToKCQkJdHJ5OgoJCQkJaWYgaS5nZXQoIm5hbWUiKSBpbiBibDpmaWlfZ3RnLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKTppLmdldCgidmFsdWUiKX0pCgkJCQllbHNlOmNvbnRpbnVlCgkJCWV4Y2VwdDpwYXNzCgkJZmlpX2d0Zy51cGRhdGUoeyJlbWFpbCI6IHVpZCwicGFzcyI6IHB3LCJwcmVmaWxsX2NvbnRhY3RfcG9pbnQiOiAiIiwicHJlZmlsbF9zb3VyY2UiOiAiIiwicHJlZmlsbF90eXBlIjogIiIsImZpcnN0X3ByZWZpbGxfc291cmNlIjogIiIsImZpcnN0X3ByZWZpbGxfdHlwZSI6ICIiLCJoYWRfY3BfcHJlZmlsbGVkIjogImZhbHNlIiwiaGFkX3Bhc3N3b3JkX3ByZWZpbGxlZCI6ICJmYWxzZSIsImlzX3NtYXJ0X2xvY2siOiAiZmFsc2UiLCJfZmJfbm9zY3JpcHQiOiAidHJ1ZSJ9KQoJCWRla3UgPSBzZXMucG9zdCgiaHR0cHM6Ly9tb2JpbGUuZmFjZWJvb2suY29tL2xvZ2luL2RldmljZS1iYXNlZC9yZWd1bGFyL2xvZ2luLz9yZWZzcmM9aHR0cHMlM0ElMkYlMkZtYmFzaWMuZmFjZWJvb2suY29tJTJGJmx3dj0xMDAmcmVmaWQ9OCIsZGF0YT1maWlfZ3RnKQoJCWlmICJjX3VzZXIiIGluIHNlcy5jb29raWVzLmdldF9kaWN0KCkua2V5cygpOgoJCQlrdWtpID0gKCI7Iikuam9pbihbICIlcz0lcyIgJSAoa2V5LCB2YWx1ZSkgZm9yIGtleSwgdmFsdWUgaW4gc2VzLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpIF0pLnJlcGxhY2UoIm5vc2NyaXB0PTE7IiwgIiIpCgkJCXByaW50KGYiXHJ7Qn0gfC0+IHtJfXt1aWR9IOKckyB7cHd9IikKCQkJb2suYXBwZW5kKCIlc3wlcyIlKHVpZCwgcHcpKQoJCQlvcGVuKCJPSy8lcy5qc29uIiUodGFuZ2dhbCksImEiKS53cml0ZSgiJXN8JXNcbiIlKHVpZCwgcHcpKQoJCQlicmVhawoJCWVsaWYgImNoZWNrcG9pbnQiIGluIHNlcy5jb29raWVzLmdldF9kaWN0KCkua2V5cygpOgoJCQl0cnk6CgkJCQl0b2tlbiAgPSBvcGVuKCdsb2dpbi90b2tlbi5qc29uJywncicpLnJlYWQoKQoJCQkJY29va2llID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0KCQkJCXdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHNlczoKCQkJCQl0dGwgPSBzZXMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcz9hY2Nlc3NfdG9rZW49JXMiJSh1aWQsIHRva2VuKSxjb29raWVzPWNvb2tpZSkuanNvbigpWyJiaXJ0aGRheSJdCgkJCQkJbW9udGgsIGRheSwgeWVhciA9IHR0bC5zcGxpdCgiLyIpCgkJCQkJbW9udGggPSBidWxhbl90dGxbbW9udGhdCgkJCQkJcHJpbnQoZiJccntCfSB8LT4ge0t9e3VpZH0gw5cge3B3feKAontkYXl9IHttb250aH0ge3llYXJ9IikKCQkJCQljcC5hcHBlbmQoIiVzfCVzIiUodWlkLCBwdykpCgkJCQkJb3BlbigiQ1AvJXMuanNvbiIlKHRhbmdnYWwpLCJhIikud3JpdGUoIiVzfCVzfCVzICVzICVzXG4iJSh1aWQsIHB3LCBkYXksIG1vbnRoLCB5ZWFyKSkKCQkJCQlicmVhawoJCQlleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKCQkJCWRheSA9ICgiICIpCgkJCQltb250aCA9ICgiICIpCgkJCQl5ZWFyID0gKCIgIikKCQkJZXhjZXB0OnBhc3MKCQkJcHJpbnQoZiJccntCfSB8LT4ge0t9e3VpZH0gw5cge3B3fSIpCgkJCWNwLmFwcGVuZCgiJXN8JXMiJSh1aWQsIHB3KSkKCQkJb3BlbigiQ1AvJXMuanNvbiIlKHRhbmdnYWwpLCJhIikud3JpdGUoIiVzfCVzXG4iJSh1aWQsIHB3KSkKCQkJYnJlYWsKCQllbHNlOgoJCQljb250aW51ZQoKCWxvb3AgKz0gMQoJCmRlZiBjZWtfbG9nKHVpZCxwdyx1YSk6CgltYiA9ICgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tIikKCXNlcyA9IHJlcXVlc3RzLlNlc3Npb24oKQoJb3B0aW9uID0gW10KCXNlcy5oZWFkZXJzLnVwZGF0ZSh7Ikhvc3QiOiAibWJhc2ljLmZhY2Vib29rLmNvbSIsImNhY2hlLWNvbnRyb2wiOiAibWF4LWFnZT0wIiwidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6ICIxIiwib3JpZ2luIjogbWIsImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCJ1c2VyLWFnZW50IjogdWEsImFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44LGFwcGxpY2F0aW9uL3NpZ25lZC1leGNoYW5nZTt2PWIzO3E9MC45IiwieC1yZXF1ZXN0ZWQtd2l0aCI6ICJtYXJrLnZpYS5ncCIsInNlYy1mZXRjaC1zaXRlIjogInNhbWUtb3JpZ2luIiwic2VjLWZldGNoLW1vZGUiOiAibmF2aWdhdGUiLCJzZWMtZmV0Y2gtdXNlciI6ICI/MSIsInNlYy1mZXRjaC1kZXN0IjogImRvY3VtZW50IiwicmVmZXJlciI6IG1iKyIvbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04IiwiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCJhY2NlcHQtbGFuZ3VhZ2UiOiAiaWQtSUQsaWQ7cT0wLjksZW4tVVM7cT0wLjgsZW47cT0wLjcifSkKCWRhdGEgPSB7fQoJZ2VkID0gcGFyc2VyKHNlcy5nZXQobWIrIi9sb2dpbi8/bmV4dCZyZWY9ZGJsJmZsJnJlZmlkPTgiLCBoZWFkZXJzPXsidXNlci1hZ2VudCI6dWF9KS50ZXh0LCAiaHRtbC5wYXJzZXIiKQoJZm0gPSBnZWQuZmluZCgiZm9ybSIseyJtZXRob2QiOiJwb3N0In0pCglsaXN0ID0gWyJsc2QiLCJqYXpvZXN0IiwibV90cyIsImxpIiwidHJ5X251bWJlciIsInVucmVjb2duaXplZF90cmllcyIsImxvZ2luIiwiYmlfeHJ3aCJdCglmb3IgaSBpbiBmbS5maW5kX2FsbCgiaW5wdXQiKToKCQlpZiBpLmdldCgibmFtZSIpIGluIGxpc3Q6CgkJCWRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOmkuZ2V0KCJ2YWx1ZSIpfSkKCQllbHNlOgoJCQljb250aW51ZQoJZGF0YS51cGRhdGUoeyJlbWFpbCI6dWlkLCJwYXNzIjpwd30pCglydW4gPSBwYXJzZXIoc2VzLnBvc3QobWIrZm0uZ2V0KCJhY3Rpb24iKSwgZGF0YT1kYXRhLCBhbGxvd19yZWRpcmVjdHM9VHJ1ZSkudGV4dCwgImh0bWwucGFyc2VyIikKCWlmICJjaGVja3BvaW50IiBpbiBzZXMuY29va2llczoKCQlmb3JtID0gcnVuLmZpbmQoImZvcm0iKQoJCWR0c2cgPSBmb3JtLmZpbmQoImlucHV0Iix7Im5hbWUiOiJmYl9kdHNnIn0pWyJ2YWx1ZSJdCgkJanpzdCA9IGZvcm0uZmluZCgiaW5wdXQiLHsibmFtZSI6Imphem9lc3QifSlbInZhbHVlIl0KCQluaCAgID0gZm9ybS5maW5kKCJpbnB1dCIseyJuYW1lIjoibmgifSlbInZhbHVlIl0KCQlkYXRhRCA9IHsiZmJfZHRzZyI6IGR0c2csImZiX2R0c2ciOiBkdHNnLCJqYXpvZXN0IjoganpzdCwiamF6b2VzdCI6IGp6c3QsImNoZWNrcG9pbnRfZGF0YSI6IiIsInN1Ym1pdFtDb250aW51ZV0iOiJMYW5qdXRrYW4iLCJuaCI6IG5ofQoJCXRlbXBlayA9IHBhcnNlcihzZXMucG9zdChtYitmb3JtWyJhY3Rpb24iXSwgZGF0YT1kYXRhRCkudGV4dCwgImh0bWwucGFyc2VyIikKCQluZ2V3ID0gW3l5LnRleHQgZm9yIHl5IGluIHRlbXBlay5maW5kX2FsbCgib3B0aW9uIildCgkJcHJpbnQoZiJccntQfVvigKJde0t9LT4ge0J9e3VpZH3igKJ7cHd9IikKCQlmb3Igb3B0IGluIHJhbmdlKGxlbihuZ2V3KSk6CgkJCWphbGFuKGYie1V9W3tCfXtzdHIob3B0KzEpfXtVfV17Qn0tPj57VX1be0J9e25nZXdbb3B0XX17VX0iKQoJCWlmICIwIiBpbiBzdHIobGVuKG5nZXcpKToKCQkJamFsYW4oZiJ7UH1b4oCiXXtJfSBIb3JlIGFrdW55YSB0YWIgeWVzc3MsIHNpbGFoa2FuIGRpIGxvZ2luICIpCgllbGlmICJsb2dpbl9lcnJvciIgaW4gc3RyKHJ1bik6CgkJamFsYW4oZiJccntQfVvigKJde0t9LT4ge0J9e3VpZH3igKJ7cHd9IikKCWVsc2U6CgkJamFsYW4oZiJccntQfVvigKJde0t9LT4ge0J9e3VpZH3igKJ7cHd9IikKCgppZiBfX25hbWVfXz09Il9fbWFpbl9fIjoKICAgIG9zLnN5c3RlbSgiY2xlYXIiKQogICAgbWtkaXJfZGF0YV9sb2dpbigpCiAgICBtZW51KCkK'))
